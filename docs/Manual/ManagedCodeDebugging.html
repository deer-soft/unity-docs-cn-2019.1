<!DOCTYPE html><html class="no-js">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-5V25JL6');
    </script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<meta property="og:title" content="Debugging C# code in Unity - Unity Manual">
<title>Debugging C# code in Unity - Unity Manual</title>
<meta property="og:image" content="https://docs.unity3d.com/zh_CN/2019.1/uploads/Main/MCDExternalTools.png">
<meta name="description" content="Using a debugger allows you to inspect your source code while your application or game is running. Unity supports debugging of C# code using the following code editors:">
<meta property="og:description" content="Using a debugger allows you to inspect your source code while your application or game is running. Unity supports debugging of C# code using the following code editors:">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="../StaticFiles/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFiles/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFiles/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFiles/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFiles/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFiles/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFiles/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFiles/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFiles/images/favicons/tileicon-144x144.png">
<script>
      var docs_type = 'Manual';
      var lang = 'zh_CN';
      var page = 'ManagedCodeDebugging';
      if(!page) page = 'index';
      var version = '2019.1';
      var docs_versions = [{version: '2019.3',version_string: '2019.3'},{version: '2019.2',version_string: '2019.2'},{version: '2019.1',version_string: '2019.1'},{version: '2018.4',version_string: '2018.4'},{version: '2018.3',version_string: '2018.3'},{version: '2018.2',version_string: '2018.2'},{version: '2018.1',version_string: '2018.1'},{version: '2017.4',version_string: '2017.4'},{version: '2017.3',version_string: '2017.3'},{version: '2017.2',version_string: '2017.2'},{version: '2017.1',version_string: '2017.1'},{version: '5.6',version_string: '560'},];</script><script type="text/javascript" src="../StaticFiles/js/jquery.js"></script><script type="text/javascript" src="../StaticFiles/js/core.js"></script><script type="text/javascript" src="../StaticFiles/js/jquery.sidebar.min.js"></script><script type="text/javascript" src="docdata/toc.js"></script><script type="text/javascript" src=""></script><script type="text/javascript" src="../StaticFiles/js/custom.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/core.css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/custom.css">
</head>
<body>
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5V25JL6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="https://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul class="menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">Manual</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">Scripting API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity3d.com/">
                unity3d.com
              </a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2019.1</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;"><ul>
<li><a class="docs_version_url_2019.3" href="/zh_CN/2019.3/Manual/ManagedCodeDebugging.html">2019.3</a></li>
<li><a class="docs_version_url_2019.2" href="/zh_CN/2019.2/Manual/ManagedCodeDebugging.html">2019.2</a></li>
<li><a class="docs_version_url_2019.1" href="/zh_CN/2019.1/Manual/ManagedCodeDebugging.html">2019.1</a></li>
<li><a class="docs_version_url_2018.4" href="/zh_CN/2018.4/Manual/ManagedCodeDebugging.html">2018.4</a></li>
<li><a class="docs_version_url_2018.3" href="/zh_CN/2018.3/Manual/ManagedCodeDebugging.html">2018.3</a></li>
<li><a class="docs_version_url_2018.2" href="/zh_CN/2018.2/Manual/ManagedCodeDebugging.html">2018.2</a></li>
<li><a class="docs_version_url_2018.1" href="/zh_CN/2018.1/Manual/ManagedCodeDebugging.html">2018.1</a></li>
<li><a class="docs_version_url_2017.4" href="/zh_CN/2017.4/Manual/ManagedCodeDebugging.html">2017.4</a></li>
<li><a class="docs_version_url_2017.3" href="/zh_CN/2017.3/Manual/ManagedCodeDebugging.html">2017.3</a></li>
<li><a class="docs_version_url_2017.2" href="/zh_CN/2017.2/Manual/ManagedCodeDebugging.html">2017.2</a></li>
<li><a class="docs_version_url_2017.1" href="/zh_CN/2017.1/Manual/ManagedCodeDebugging.html">2017.1</a></li>
<li><a class="docs_version_url_560" href="/zh_CN/560/Manual/ManagedCodeDebugging.html">5.6</a></li>
</ul></div>
</div>
<ul class="nav-menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">Manual</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">Scripting API</a></li>
</ul>
<div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">Language:
        <span class="b">中文</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a data-lang="en" href="/2019.1/Documentation/Manual/ManagedCodeDebugging.html">English</a></li>
<li><a data-lang="ja" href="/ja/2019.1/Manual/ManagedCodeDebugging.html">日本語</a></li>
<li><a data-lang="es" href="/es/2019.1/Manual/ManagedCodeDebugging.html">Español</a></li>
<li><a data-lang="kr" href="/kr/2019.1/Manual/ManagedCodeDebugging.html">한국어</a></li>
</ul></div>
</div>
</div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar hidden"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc">
<h2>Manual</h2>
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2019.1</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;"><ul>
<li><a class="docs_version_url_2019.3" href="/zh_CN/2019.3/Manual/ManagedCodeDebugging.html">2019.3</a></li>
<li><a class="docs_version_url_2019.2" href="/zh_CN/2019.2/Manual/ManagedCodeDebugging.html">2019.2</a></li>
<li><a class="docs_version_url_2019.1" href="/zh_CN/2019.1/Manual/ManagedCodeDebugging.html">2019.1</a></li>
<li><a class="docs_version_url_2018.4" href="/zh_CN/2018.4/Manual/ManagedCodeDebugging.html">2018.4</a></li>
<li><a class="docs_version_url_2018.3" href="/zh_CN/2018.3/Manual/ManagedCodeDebugging.html">2018.3</a></li>
<li><a class="docs_version_url_2018.2" href="/zh_CN/2018.2/Manual/ManagedCodeDebugging.html">2018.2</a></li>
<li><a class="docs_version_url_2018.1" href="/zh_CN/2018.1/Manual/ManagedCodeDebugging.html">2018.1</a></li>
<li><a class="docs_version_url_2017.4" href="/zh_CN/2017.4/Manual/ManagedCodeDebugging.html">2017.4</a></li>
<li><a class="docs_version_url_2017.3" href="/zh_CN/2017.3/Manual/ManagedCodeDebugging.html">2017.3</a></li>
<li><a class="docs_version_url_2017.2" href="/zh_CN/2017.2/Manual/ManagedCodeDebugging.html">2017.2</a></li>
<li><a class="docs_version_url_2017.1" href="/zh_CN/2017.1/Manual/ManagedCodeDebugging.html">2017.1</a></li>
<li><a class="docs_version_url_560" href="/zh_CN/560/Manual/ManagedCodeDebugging.html">5.6</a></li>
</ul></div>
</div>
<div class="clear"></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap opened-sidebar"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity User Manual (2019.1)</a></li>
<li><a href="ScriptingSection.html">脚本</a></li>
<li><a href="ScriptingTools.html">脚本工具</a></li>
<li>Debugging C# code in Unity</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="ScriptingToolsIDEs.html"></a></span><div class="tip">Integrated development environment (IDE) support</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="EventSystem.html"></a></span><div class="tip">事件系统</div>
</div>
</div></div>
<h1>Debugging C# code in Unity</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>Using a debugger allows you to inspect your source code while your application or game is running. Unity supports debugging of C# code using the following code editors:</p>

<ul>
<li><p>Visual Studio (with the Visual Studio Tools for Unity plug-in)</p></li>
<li><p>Visual Studio for Mac</p></li>
<li><p>Jetbrains Rider</p></li>
<li><p>Visual Studio Code</p></li>
</ul>

<p>Although these code editors vary slightly in the debugger features they support, all provide basic functionality like break points, single stepping, and variable inspection.</p>

<p>Managed code debugging in Unity works on all platforms except WebGL. It works with both the Mono and IL2CPP scripting backends.</p>

<p><a name="ConfiguringTheCodeEditor"></a></p>

<h2>Configuring the code editor</h2>

<h3>Visual Studio (Windows)</h3>

<p>The Unity Editor installer includes an option to install Visual Studio with the Visual Studio Tools for Unity plug-in. This is the recommended way to set up Visual Studio for debugging with Unity.</p>

<p>If Visual Studio is already installed on your computer, use its <strong>Tools</strong> &gt; <strong>Extensions and Updates</strong> menu to locate and install the Visual Studio Tools for Unity plug-in.</p>

<h3>Visual Studio for Mac</h3>

<p>The Unity Editor installer includes an option to install Visual Studio for Mac. This is the recommended way to set up Visual Studio for Mac for debugging with Unity.</p>

<p>If Visual Studio for Mac is already installed on your computer, use its Extension Manager to locate and install the Visual Studio Tools for Unity plug-in.</p>

<h3>JetBrains Rider</h3>

<p>The default installation of JetBrains Rider can debug code in Unity on Windows or Mac. Please visit the <a href="https://www.jetbrains.com/help/rider/Unity.html">JetBrains website</a> to install it.</p>

<h3>VS Code</h3>

<p>VS Code requires you to install an extension to debug code in Unity. Please follow the <a href="https://code.visualstudio.com/docs/other/unity">instructions</a> specific to this extension to install it.</p>

<h3>Unity Preferences</h3>

<p>When the code editor is installed, go to <strong>Unity &gt; Preferences &gt; External Tools</strong> and set the <strong>External Script Editor</strong> to your chosen code editor.
<img src="../uploads/Main/MCDExternalTools.png" alt=""></p>

<h2>Debugging in the Editor</h2>

<p>You can debug script code running in the Unity Editor when the Unity Editor is in Play Mode. Before attempting to debug, ensure the <strong>Editor Attaching</strong> option is enabled in the Unity Preferences. This option causes the Editor to use Just In Time (JIT) compilation to execute managed code with debugging information.</p>

<p>First, set a breakpoint in the code editor on a line of script code where the debugger should stop. In Visual Studio for example, click on the column to the left of your code, on the line you want to stop the debugger (as shown below). A red circle appears next to the line number and the line is highlighted.</p>

<figure>
<img src="../uploads/Main/MCDBreakPoints.png" alt="">
</figure>

<p>Next, attach the code editor to the Unity Editor. This option varies depending on the code editor, and is often a different option from the code editor’s normal debugging process. In Visual Studio, the option looks like this:</p>

<figure>
<img src="../uploads/Main/MCDAttachToUnity.png" alt="">
</figure>

<p>Some code editors may allow you to select an instance of Unity to debug. For example, in Visual Studio, the <strong>Debug &gt; Attach Unity Debugger</strong> option exposes this capability.</p>

<figure>
<img src="../uploads/Main/MCDEditorUnityInstance.png" alt="">
</figure>

<p>When you have attached the code editor to the Unity Editor, return to the Unity Editor and enter Play Mode. When the code at the breakpoint is executed, the debugger will stop, for example:</p>

<figure>
<img src="../uploads/Main/MCDReachedBreakPoint.png" alt="">
</figure>

<p>While the code editor is at a breakpoint, you can view the contents of variables step by step. The Unity Editor will be unresponsive until you choose the continue option in the debugger, or stop debugging mode.</p>

<h2>Debugging in the Player</h2>

<p>To debug script code running in a Unity Player, ensure that you enable the “Development Build” and “Script Debugging” options before you build the Player (these options are located in <strong>File &gt; Build Settings</strong>). Enable the “Wait For Managed Debugger” option to make the Player wait for a debugger to be attached before it executes any script code.</p>

<figure>
<img src="../uploads/Main/MCDBuildSettings.png" alt="">
</figure>

<p>To attach the code editor to the Unity Player, select the IP address (or machine name) and port of your Player. In Visual Studio, the drop-down menu on the “Attach To Unity” option looks like this:</p>

<figure>
<img src="../uploads/Main/MCDAttachToUnityDropDown.png" alt="">
</figure>

<p>The <strong>Debug</strong> &gt; <strong>Attach Unity Debugger</strong> option looks like this:</p>

<figure>
<img src="../uploads/Main/MCDSelectUnityInstancePlayer.png" alt="">
</figure>

<p>Make sure you attach the debugger to the Player, and not to the Unity Editor (if both are running). When you have attached the debugger, you can proceed with debugging normally.</p>

<h2>Debugging on Android and iOS devices</h2>

<h3>Android</h3>

<p>When debugging a Player running on an Android device, connect to the device via USB or TCP. For example, to connect to an Android device in Visual Studio (Windows), select <strong>Debug &gt; Attach Unity Debugger</strong> option. A list of devices running a Player instance will appear: </p>

<figure>
<img src="../uploads/Main/MCDUnityInstanceAndroidOrIOS.png" alt="">
</figure>

<p>In this case, the phone is connected via USB and Wi-Fi on the same network as the workstation running the Unity Editor and Visual Studio.</p>

<h3>iOS</h3>

<p>When debugging a Player running on an iOS device, connect to the device via TCP. For example, to connect to an iOS device in Visual Studio (Mac), select <strong>Debug</strong> &gt; <strong>Attach Unity Debugger</strong> option. A list of devices running a Player instance will appear: </p>

<figure>
<img src="../uploads/Main/MCDMacIOSAttach.png" alt="">
</figure>

<p>Ensure that the device only has one active network interface (Wi-Fi recommended, turn off cellular data) and that there is no firewall between the IDE and the device blocking the TCP port (port number 56000 in the above screenshot). Debugging over USB is not supported with iOS.</p>

<h2>Troubleshooting the debugger</h2>

<p>Most problems with the debugger occur because the code editor is unable to locate the Unity Editor or the Player. This means that it can’t attach the debugger properly. Because the debugger uses a TCP connection to the Editor or Player, connection issues are often caused by the network. Here are a few steps you can take to troubleshoot basic connection issues.</p>

<h3>Ensure you attach the debugger to the correct Unity instance</h3>

<p>You can attach code editor to any Unity Editor or Unity Player on the local network that has debugging enabled. When attaching the debugger to ensure that you are attaching to the correct instance. If you know the IP address or machine name of the device on which you are running the Unity Player, this helps to locate the correct instance.</p>

<h3>Verify the network connection to the Unity instance</h3>

<p>The code editor uses the same mechanism to locate a Unity instance to debug as the Unity Profiler uses. If the code editor cannot find the Unity instance you expect it to find, try to attach the Unity Profiler to that instance. If the Unity Profiler cannot find it either, a firewall might exist on the machine which you are running the code editor on or the machine which you are running the Unity instance on (or possibly both). If a firewall is in place, see the information <a href="#firewall">about firewall settings below.</a></p>

<h3>Ensure the device has only one active network interface</h3>

<p>Many devices have multiple network interfaces. For example, a mobile phone may have both an active cellular connection and an active Wi-Fi connection. To properly connect the debugger for TCP, the IDE needs to make a network connection to the correct interface on the device. If you plan to debug via Wi-Fi, for example, make sure you put the device in airplane mode to disable all other interfaces, then enable Wi-Fi.</p>

<p>You can determine which IP address the Unity Player is telling the IDE to use by looking in the Player Log. Look for a part of the log like this:</p>

<pre><code>
Multi-casting "[IP] 10.0.1.152 [Port] 55000 [Flags] 3 [Guid] 2575380029 [EditorId] 4264788666 [Version] 1048832 [Id] iPhonePlayer(Joshs-iPhone):56000 [Debug] 1 [PackageName] iPhonePlayer" to [225.0.0.222:54997]...

</code></pre>

<p>This message indicates the IDE will try to use the IP address 10.0.1.152 and port 56000 to connect to the device. This IP address and port must be reachable from the computer running the IDE.</p>

<p><a name="firewall"></a></p>

<h3>Check the firewall settings</h3>

<p>The Unity instance communicates with the code editor via a TCP connection. On most Unity platforms, this TCP connection occurs on an arbitrarily chosen port. Normally, you should not need to know this port, as the code editor should detect it automatically. If that does not work, try to use a network analysis tool to determine which ports might be blocked either on the machine where you are running the code editor, or the machine or device where you are running the Unity instance. When you find the ports, make sure that your firewall allows access to both the port on the machine running the code editor, and the machine running the Unity instance.</p>

<h3>Verify the managed debugging information is available</h3>

<p>If the debugger does attach, but breakpoints don’t load, the debugger may not be able to locate the managed debugging information for the code. Managed code debugging information is stored in files named .dll.mdb or .pdb, next to the managed assembly (.dll file) on disk.</p>

<p>When the correct preferences and build options are enabled (<a href="#ConfiguringTheCodeEditor">see above</a>, Unity will generate this debugging information automatically. However, Unity cannot generate this debugging information for managed plugins in the Project. It is possible to debug code from managed plugins if the associated .dll.mdb or .pdb files are next to the managed plugins in the Unity project on disk.</p>

<h3>Prevent the device from locking</h3>

<p>If the device you are using to debug the application has a screen lock, make sure this is disabled. Screen locks cause the debugger to disconnect, and prevent it from re-connecting. It is best to avoid locking the screen during managed code debugging. If the screen does lock, you should restart the application on the device before the debugger can connect again.</p>

<ul>
<li><p><span class="page-edit">2018–09–06 Page published with <a href="DocumentationEditorialReview.html">editorial review</a>
</span></p></li>
<li><p><span class="page-history">Managed Code Debugging added in 2018.2</span></p></li>
</ul>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="ScriptingToolsIDEs.html"></a></span><div class="tip">Integrated development environment (IDE) support</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="EventSystem.html"></a></span><div class="tip">事件系统</div>
</div>
</div>
</div>
<div class="footer-wrapper">
<div class="footer clear">
<div class="copy">Copyright © 2019 Unity Technologies. Publication 2019.1</div>
<div class="menu">
<a href="https://unity3d.com/learn">Tutorials</a><a href="https://answers.unity3d.com">Community Answers</a><a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a><a href="https://forum.unity3d.com">Forums</a><a href="https://unity3d.com/asset-store">Asset Store</a>
</div>
</div>
<div></div>
</div>
</div></div></div>
</div>
</body>
</html>
