<!DOCTYPE html><html class="no-js"><head><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-5V25JL6');
    </script><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="twitter:card" content="summary" /><meta name="robots" content="noindex" /><meta property="og:title" content="WWW-LoadFromCacheOrDownload - Unity Scripting API" /><title>WWW-LoadFromCacheOrDownload - Unity Scripting API</title><meta name="description" content="从缓存中加载具有指定版本号的 AssetBundle。如果当前未缓存该 AssetBundle，则自动下载该 AssetBundle 并将其存储在缓存中，以便将来从本地存储检索。" /><meta property="og:description" content="从缓存中加载具有指定版本号的 AssetBundle。如果当前未缓存该 AssetBundle，则自动下载该 AssetBundle 并将其存储在缓存中，以便将来从本地存储检索。" /><meta name="author" content="Unity Technologies" /><link rel="shortcut icon" href="../StaticFiles/images/favicons/favicon.ico" /><link rel="icon" type="image/png" href="../StaticFiles/images/favicons/favicon.png" /><link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFiles/images/favicons/apple-touch-icon-152x152.png" /><link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFiles/images/favicons/apple-touch-icon-144x144.png" /><link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFiles/images/favicons/apple-touch-icon-120x120.png" /><link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFiles/images/favicons/apple-touch-icon-114x114.png" /><link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFiles/images/favicons/apple-touch-icon-72x72.png" /><link rel="apple-touch-icon-precomposed" href="../StaticFiles/images/favicons/apple-touch-icon.png" /><meta name="msapplication-TileColor" content="#222c37" /><meta name="msapplication-TileImage" content="../StaticFiles/images/favicons/tileicon-144x144.png" /><script>
      var docs_type = 'ScriptReference';
      var lang = 'zh_CN';
      var page = 'WWW-LoadFromCacheOrDownload';
      if(!page) page = 'index';
      var version = '2019.1';
      var docs_versions = [{version: '2019.3',version_string: '2019.3'},{version: '2019.2',version_string: '2019.2'},{version: '2019.1',version_string: '2019.1'},{version: '2018.4',version_string: '2018.4'},{version: '2018.3',version_string: '2018.3'},{version: '2018.2',version_string: '2018.2'},{version: '2018.1',version_string: '2018.1'},{version: '2017.4',version_string: '2017.4'},{version: '2017.3',version_string: '2017.3'},{version: '2017.2',version_string: '2017.2'},{version: '2017.1',version_string: '2017.1'},{version: '5.6',version_string: '560'},];</script><script type="text/javascript" src="../StaticFiles/js/jquery.js"></script><script type="text/javascript" src="../StaticFiles/js/core.js"></script><script type="text/javascript" src="../StaticFiles/js/jquery.sidebar.min.js"></script><script type="text/javascript" src="docdata/toc.js"></script><script type="text/javascript" src=""></script><script type="text/javascript" src="../StaticFiles/js/custom.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic" rel="stylesheet" type="text/css" /><link rel="stylesheet" type="text/css" href="../StaticFiles/css/core.css" /><link rel="stylesheet" type="text/css" href="../StaticFiles/css/custom.css" /></head><body><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5V25JL6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="header-wrapper"><div id="header" class="header"><div class="content"><div class="spacer"><div class="menu"><div id="nav-open" for="nav-input"><span></span></div><div class="logo"><a href="https://docs.unity3d.com"></a></div><div class="search-form"><form action="30_search.html" method="get" class="apisearch"><input type="text" name="q" placeholder="Search scripting..." autosave="Unity Reference" results="5" class="sbox field" id="q"></input><input type="submit" class="submit"></input></form></div><ul class="menu-items"><li class="menu-item"><a href="../Manual/index.html" class="">Manual</a></li><li class="menu-item"><a href="../ScriptReference/index.html" class="selected">Scripting API</a></li></ul></div></div><div class="more"><div class="filler"></div><ul><li><a href="https://unity3d.com/">
                unity3d.com
              </a></li></ul></div></div></div><div class="toolbar"><div class="content"><div class="version-switcher"><div class="current toggle" data-target=".version-list"><div class="version-number"><div class="d-inline-block">
          Version:
          <b>2019.1</b></div><div class="d-inline-block arrow"></div></div></div><div class="version-list" style="display:none;"><ul><li><a class="docs_version_url_2019.3" href="/zh_CN/2019.3/ScriptReference/WWW-LoadFromCacheOrDownload.html">2019.3</a></li><li><a class="docs_version_url_2019.2" href="/zh_CN/2019.2/ScriptReference/WWW-LoadFromCacheOrDownload.html">2019.2</a></li><li><a class="docs_version_url_2019.1" href="/zh_CN/2019.1/ScriptReference/WWW-LoadFromCacheOrDownload.html">2019.1</a></li><li><a class="docs_version_url_2018.4" href="/zh_CN/2018.4/ScriptReference/WWW-LoadFromCacheOrDownload.html">2018.4</a></li><li><a class="docs_version_url_2018.3" href="/zh_CN/2018.3/ScriptReference/WWW-LoadFromCacheOrDownload.html">2018.3</a></li><li><a class="docs_version_url_2018.2" href="/zh_CN/2018.2/ScriptReference/WWW-LoadFromCacheOrDownload.html">2018.2</a></li><li><a class="docs_version_url_2018.1" href="/zh_CN/2018.1/ScriptReference/WWW-LoadFromCacheOrDownload.html">2018.1</a></li><li><a class="docs_version_url_2017.4" href="/zh_CN/2017.4/ScriptReference/WWW-LoadFromCacheOrDownload.html">2017.4</a></li><li><a class="docs_version_url_2017.3" href="/zh_CN/2017.3/ScriptReference/WWW-LoadFromCacheOrDownload.html">2017.3</a></li><li><a class="docs_version_url_2017.2" href="/zh_CN/2017.2/ScriptReference/WWW-LoadFromCacheOrDownload.html">2017.2</a></li><li><a class="docs_version_url_2017.1" href="/zh_CN/2017.1/ScriptReference/WWW-LoadFromCacheOrDownload.html">2017.1</a></li><li><a class="docs_version_url_560" href="/zh_CN/560/ScriptReference/WWW-LoadFromCacheOrDownload.html">5.6</a></li></ul></div></div><ul class="nav-menu-items"><li class="menu-item"><a href="../Manual/index.html" class="">Manual</a></li><li class="menu-item"><a href="../ScriptReference/index.html" class="selected">Scripting API</a></li></ul><div class="lang-switcher"><div class="current toggle" data-target=".lang-list"><div class="lbl">Language:
        <span class="b">中文</span></div><div class="arrow"></div></div><div class="lang-list" style="display:none;"><ul><li><a data-lang="en" href="/2019.1/Documentation/ScriptReference/WWW-LoadFromCacheOrDownload.html">English</a></li><li><a data-lang="ja" href="/ja/2019.1/ScriptReference/WWW-LoadFromCacheOrDownload.html">日本語</a></li><li><a data-lang="es" href="/es/2019.1/ScriptReference/WWW-LoadFromCacheOrDownload.html">Español</a></li><li><a data-lang="kr" href="/kr/2019.1/ScriptReference/WWW-LoadFromCacheOrDownload.html">한국어</a></li></ul></div></div></div></div></div><div id="master-wrapper" class="master-wrapper clear"><div id="sidebar" class="sidebar hidden"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc"><h2>Scripting API</h2><div class="version-switcher"><div class="current toggle" data-target=".version-list"><div class="version-number"><div class="d-inline-block">
          Version:
          <b>2019.1</b></div><div class="d-inline-block arrow"></div></div></div><div class="version-list" style="display:none;"><ul><li><a class="docs_version_url_2019.3" href="/zh_CN/2019.3/ScriptReference/WWW-LoadFromCacheOrDownload.html">2019.3</a></li><li><a class="docs_version_url_2019.2" href="/zh_CN/2019.2/ScriptReference/WWW-LoadFromCacheOrDownload.html">2019.2</a></li><li><a class="docs_version_url_2019.1" href="/zh_CN/2019.1/ScriptReference/WWW-LoadFromCacheOrDownload.html">2019.1</a></li><li><a class="docs_version_url_2018.4" href="/zh_CN/2018.4/ScriptReference/WWW-LoadFromCacheOrDownload.html">2018.4</a></li><li><a class="docs_version_url_2018.3" href="/zh_CN/2018.3/ScriptReference/WWW-LoadFromCacheOrDownload.html">2018.3</a></li><li><a class="docs_version_url_2018.2" href="/zh_CN/2018.2/ScriptReference/WWW-LoadFromCacheOrDownload.html">2018.2</a></li><li><a class="docs_version_url_2018.1" href="/zh_CN/2018.1/ScriptReference/WWW-LoadFromCacheOrDownload.html">2018.1</a></li><li><a class="docs_version_url_2017.4" href="/zh_CN/2017.4/ScriptReference/WWW-LoadFromCacheOrDownload.html">2017.4</a></li><li><a class="docs_version_url_2017.3" href="/zh_CN/2017.3/ScriptReference/WWW-LoadFromCacheOrDownload.html">2017.3</a></li><li><a class="docs_version_url_2017.2" href="/zh_CN/2017.2/ScriptReference/WWW-LoadFromCacheOrDownload.html">2017.2</a></li><li><a class="docs_version_url_2017.1" href="/zh_CN/2017.1/ScriptReference/WWW-LoadFromCacheOrDownload.html">2017.1</a></li><li><a class="docs_version_url_560" href="/zh_CN/560/ScriptReference/WWW-LoadFromCacheOrDownload.html">5.6</a></li></ul></div></div><div class="clear"></div></div></div></div></div></div><div id="content-wrap" class="content-wrap opened-sidebar"><div class="content-block"><div class="content"><div class="section"><div class="mb20 clear" id=""><div class="message message-error mb20"><b>Method group is Obsolete</b><br /></div><h1 class="heading inherit"><a href="WWW.html">WWW</a>.LoadFromCacheOrDownload</h1><div class="clear"></div><div class="clear"></div><a href="" class="switch-link gray-btn sbtn left hide">Switch to Manual</a><div class="clear"></div></div><div class="subsection"><div class="signature"><div class="signature-CS sig-block"><span style="color:red;">Obsolete </span>public static WWW <span class="sig-kw">LoadFromCacheOrDownload</span>
        (string <span class="sig-kw">url</span>,
    int <span class="sig-kw">version</span>);
      </div><div class="signature-CS sig-block"><span style="color:red;">Obsolete </span>public static WWW <span class="sig-kw">LoadFromCacheOrDownload</span>
        (string <span class="sig-kw">url</span>,
    int <span class="sig-kw">version</span>,
    uint <span class="sig-kw">crc</span>);
      </div><div class="signature-CS sig-block"><span style="color:red;">Obsolete </span>public static WWW <span class="sig-kw">LoadFromCacheOrDownload</span>
        (string <span class="sig-kw">url</span>,
    <a href="Hash128.html">Hash128</a> <span class="sig-kw">hash</span>,
    uint <span class="sig-kw">crc</span>);
      </div><div class="signature-CS sig-block"><span style="color:red;">Obsolete </span>public static WWW <span class="sig-kw">LoadFromCacheOrDownload</span>
        (string <span class="sig-kw">url</span>,
    <a href="CachedAssetBundle.html">CachedAssetBundle</a> <span class="sig-kw">cachedBundle</span>,
    uint <span class="sig-kw">crc</span>);
      </div></div></div><div class="subsection"><h2>Parameters</h2><table class="list"><tr><td class="name lbl">url</td><td class="desc">当缓存中不存在该 AssetBundle 时，用于下载该 AssetBundle 的 URL。必须经过“%”转义处理。</td></tr><tr><td class="name lbl">version</td><td class="desc">AssetBundle 的版本。仅当文件以前被下载过并且具有相同的 <code class="varname">version</code> 参数时，才会从磁盘缓存加载该文件。通过递增应用程序请求的版本号，您可以强制缓存从 <code class="varname">url</code> 下载 AssetBundle 的新副本。</td></tr><tr><td class="name lbl">hash</td><td class="desc">用作 AssetBundle 版本的 Hash128。</td></tr><tr><td class="name lbl">cachedBundle</td><td class="desc">用于将给定版本的资源捆绑包下载到自定义缓存路径的结构。<br /><br />类似于 <a href="Networking.UnityWebRequestAssetBundle.GetAssetBundle.html">UnityWebRequestAssetBundle.GetAssetBundle</a>.&lt;/param&gt; 的 <code class="varname">cachedAssetBundle</code> 参数。</td></tr><tr><td class="name lbl">crc</td><td class="desc">未压缩内容的 CRC-32 校验和（可选）。如果为非零值，则加载前会将内容与校验和进行比较，如果不匹配则给出错误。使用该方法可避免因下载问题或用户篡改磁盘上的缓存文件而导致的数据损坏。如果 CRC 不匹配，Unity 将尝试重新下载数据，如果服务器上的 CRC 不匹配，则下载失败并返回错误。查看返回的错误字符串，以了解用于 AssetBundle 的正确 CRC 值。</td></tr></table></div><div class="subsection"><h2>Returns</h2><p><strong>WWW</strong>
        一个 WWW 实例，可在加载/下载操作完成后用于访问数据。
      </p></div><div class="subsection"><h2>Description</h2><p>从缓存中加载具有指定版本号的 AssetBundle。如果当前未缓存该 AssetBundle，则自动下载该 AssetBundle 并将其存储在缓存中，以便将来从本地存储检索。</p></div><div class="subsection"><p>必须使用 LoadFromCacheOrDownload() 代替“new WWW (url)”，以便利用缓存功能。<br /><br />缓存的资源包仅由文件名和版本唯一标识。缓存过程将忽略 <code class="varname">url</code> 中的所有域和路径信息。由于缓存的资源捆绑包由文件名而非完整的 URL 标识，您可以随时更改资源捆绑包的下载目录。这对于推出新版本游戏并确保浏览器或 CDN 不会错误地缓存文件非常有用。<br /><br />Usually using the filename of the AssetBundle to generate the cache path is fine. But if there are different AssetBundles with the same last file name, cache conflicts will happen. With CachedAssetBundle, users can use <a href="CachedAssetBundle-name.html">CachedAssetBundle.name</a> to customized the cache path to avoid the cache conflicts. Users can also utilize this to organize the cache data structure.<br /><br />如果缓存文件夹没有任何空间来缓存其他文件，LoadFromCacheOrDownload 将以迭代方式从缓存中删除最近最少使用的 AssetBundle，直到有足够的空间来存储新的 AssetBundle。如果无法腾出空间（因为硬盘已满，或者缓存中的所有文件当前都处于使用状态），LoadFromCacheOrDownload() 将不使用缓存并将文件流式传输到内存中，就像普通的“new WWW()”调用一样。<br /><br />根据 <a href="Caching-compressionEnabled.html">Caching.compressionEnabled</a> 值，缓存数据可以以压缩格式存储。<br /><br />该函数只能用于访问 AssetBundle。无法缓存其他类型或内容。<br /><br />传递给该函数的 CRC 在 Asset Bundle 构建期间计算，请参阅 <a href="BuildPipeline.BuildAssetBundles.html">BuildPipeline.BuildAssetBundles</a>。<br /><br /><strong><em>注意：</em></strong> URL 必须经过“%”转义处理。</p></div><div class="subsection">
        
        <pre class="codeExampleCS">
using UnityEngine;
using System.Collections;<br /><br />public class LoadFromCacheOrDownloadExample : <a href="MonoBehaviour.html">MonoBehaviour</a>
{
    IEnumerator Start()
    {
        while (!<a href="Caching-ready.html">Caching.ready</a>)
            yield return null;<br /><br />        using (var www = WWW.LoadFromCacheOrDownload("http://myserver.com/myassetBundle.unity3d", 5))
        {
            yield return www;
            if (!string.IsNullOrEmpty(www.error))
            {
                <a href="Debug.Log.html">Debug.Log</a>(www.error);
                yield return null;
            }
            var myLoadedAssetBundle = www.assetBundle;<br /><br />            var asset = myLoadedAssetBundle.mainAsset;
        }
    }
}
</pre>
      </div><div class="subsection"><p>另请参阅：<a href="BuildPipeline.BuildAssetBundles.html">BuildPipeline.BuildAssetBundles</a>。</p></div></div><div class="footer-wrapper"><div class="footer clear"><div class="copy">Copyright © 2019 Unity Technologies. Publication 2019.1</div><div class="menu"><a href="https://unity3d.com/learn">Tutorials</a><a href="https://answers.unity3d.com">Community Answers</a><a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a><a href="https://forum.unity3d.com">Forums</a><a href="https://unity3d.com/asset-store">Asset Store</a></div></div><div></div></div></div></div></div></div></body></html>