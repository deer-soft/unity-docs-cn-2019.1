<!DOCTYPE html><html class="no-js">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-5V25JL6');
    </script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<meta property="og:title" content="Cache Server - Unity Manual">
<title>Cache Server - Unity Manual</title>
<meta property="og:image" content="https://docs.unity3d.com/zh_CN/2019.1/uploads/Main/CacheServerZipCropped.png">
<meta name="description" content="Unity 有一个完全自动的资源管线。每当修改 .psd 或 .fbx 文件等源资源时，Unity 都会检测到更改并自动将其重新导入。随后，Unity 以内部格式存储从文件导入的数据。">
<meta property="og:description" content="Unity 有一个完全自动的资源管线。每当修改 .psd 或 .fbx 文件等源资源时，Unity 都会检测到更改并自动将其重新导入。随后，Unity 以内部格式存储从文件导入的数据。">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="../StaticFiles/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFiles/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFiles/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFiles/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFiles/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFiles/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFiles/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFiles/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFiles/images/favicons/tileicon-144x144.png">
<script>
      var docs_type = 'Manual';
      var lang = 'zh_CN';
      var page = 'CacheServer';
      if(!page) page = 'index';
      var version = '2019.1';
      var docs_versions = [{version: '2019.3',version_string: '2019.3'},{version: '2019.2',version_string: '2019.2'},{version: '2019.1',version_string: '2019.1'},{version: '2018.4',version_string: '2018.4'},{version: '2018.3',version_string: '2018.3'},{version: '2018.2',version_string: '2018.2'},{version: '2018.1',version_string: '2018.1'},{version: '2017.4',version_string: '2017.4'},{version: '2017.3',version_string: '2017.3'},{version: '2017.2',version_string: '2017.2'},{version: '2017.1',version_string: '2017.1'},{version: '5.6',version_string: '560'},];</script><script type="text/javascript" src="../StaticFiles/js/jquery.js"></script><script type="text/javascript" src="../StaticFiles/js/core.js"></script><script type="text/javascript" src="../StaticFiles/js/jquery.sidebar.min.js"></script><script type="text/javascript" src="docdata/toc.js"></script><script type="text/javascript" src=""></script><script type="text/javascript" src="../StaticFiles/js/custom.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/core.css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/custom.css">
</head>
<body>
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5V25JL6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="https://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul class="menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">Manual</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">Scripting API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity3d.com/">
                unity3d.com
              </a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2019.1</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;"><ul>
<li><a class="docs_version_url_2019.3" href="/zh_CN/2019.3/Manual/CacheServer.html">2019.3</a></li>
<li><a class="docs_version_url_2019.2" href="/zh_CN/2019.2/Manual/CacheServer.html">2019.2</a></li>
<li><a class="docs_version_url_2019.1" href="/zh_CN/2019.1/Manual/CacheServer.html">2019.1</a></li>
<li><a class="docs_version_url_2018.4" href="/zh_CN/2018.4/Manual/CacheServer.html">2018.4</a></li>
<li><a class="docs_version_url_2018.3" href="/zh_CN/2018.3/Manual/CacheServer.html">2018.3</a></li>
<li><a class="docs_version_url_2018.2" href="/zh_CN/2018.2/Manual/CacheServer.html">2018.2</a></li>
<li><a class="docs_version_url_2018.1" href="/zh_CN/2018.1/Manual/CacheServer.html">2018.1</a></li>
<li><a class="docs_version_url_2017.4" href="/zh_CN/2017.4/Manual/CacheServer.html">2017.4</a></li>
<li><a class="docs_version_url_2017.3" href="/zh_CN/2017.3/Manual/CacheServer.html">2017.3</a></li>
<li><a class="docs_version_url_2017.2" href="/zh_CN/2017.2/Manual/CacheServer.html">2017.2</a></li>
<li><a class="docs_version_url_2017.1" href="/zh_CN/2017.1/Manual/CacheServer.html">2017.1</a></li>
<li><a class="docs_version_url_560" href="/zh_CN/560/Manual/CacheServer.html">5.6</a></li>
</ul></div>
</div>
<ul class="nav-menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">Manual</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">Scripting API</a></li>
</ul>
<div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">Language:
        <span class="b">中文</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a data-lang="en" href="/2019.1/Documentation/Manual/CacheServer.html">English</a></li>
<li><a data-lang="ja" href="/ja/2019.1/Manual/CacheServer.html">日本語</a></li>
<li><a data-lang="es" href="/es/2019.1/Manual/CacheServer.html">Español</a></li>
<li><a data-lang="kr" href="/kr/2019.1/Manual/CacheServer.html">한국어</a></li>
</ul></div>
</div>
</div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar hidden"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc">
<h2>Manual</h2>
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2019.1</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;"><ul>
<li><a class="docs_version_url_2019.3" href="/zh_CN/2019.3/Manual/CacheServer.html">2019.3</a></li>
<li><a class="docs_version_url_2019.2" href="/zh_CN/2019.2/Manual/CacheServer.html">2019.2</a></li>
<li><a class="docs_version_url_2019.1" href="/zh_CN/2019.1/Manual/CacheServer.html">2019.1</a></li>
<li><a class="docs_version_url_2018.4" href="/zh_CN/2018.4/Manual/CacheServer.html">2018.4</a></li>
<li><a class="docs_version_url_2018.3" href="/zh_CN/2018.3/Manual/CacheServer.html">2018.3</a></li>
<li><a class="docs_version_url_2018.2" href="/zh_CN/2018.2/Manual/CacheServer.html">2018.2</a></li>
<li><a class="docs_version_url_2018.1" href="/zh_CN/2018.1/Manual/CacheServer.html">2018.1</a></li>
<li><a class="docs_version_url_2017.4" href="/zh_CN/2017.4/Manual/CacheServer.html">2017.4</a></li>
<li><a class="docs_version_url_2017.3" href="/zh_CN/2017.3/Manual/CacheServer.html">2017.3</a></li>
<li><a class="docs_version_url_2017.2" href="/zh_CN/2017.2/Manual/CacheServer.html">2017.2</a></li>
<li><a class="docs_version_url_2017.1" href="/zh_CN/2017.1/Manual/CacheServer.html">2017.1</a></li>
<li><a class="docs_version_url_560" href="/zh_CN/560/Manual/CacheServer.html">5.6</a></li>
</ul></div>
</div>
<div class="clear"></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap opened-sidebar"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity User Manual (2019.1)</a></li>
<li><a href="UnityOverview.html">在 Unity 中操作</a></li>
<li><a href="AdvancedEditor.html">Editor 高级主题</a></li>
<li>Cache Server</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="ClassIDReference.html"></a></span><div class="tip">YAML 类 ID 参考</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="ModifyingSourceAssetsThroughScripting.html"></a></span><div class="tip">通过脚本修改源资源</div>
</div>
</div></div>
<h1>Cache Server</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>Unity 有一个完全自动的资源管线。每当修改 .psd 或 .fbx 文件等源资源时，Unity 都会检测到更改并自动将其重新导入。随后，Unity 以内部格式存储从文件导入的数据。</p>

<p>这种安排旨在使工作流程对于个人用户而言尽可能高效和灵活。但是，在团队中工作时，可能会发现其他用户可能会继续对资源进行更改，所有这些更改都必须导入。此外，在桌面和移动构建目标平台之间切换时，必须重新导入资源。因此，该切换对于大型项目而言可能需要很长时间。</p>

<p>在__缓存服务器__上缓存导入的资源数据可以大大减少导入资源所需的时间。</p>

<p>Unity caches each Asset import based on: </p>

<ul>
<li>资源文件本身</li>
<li>The Import settings</li>
<li>The Asset importer version</li>
<li>当前平台</li>
</ul>

<p>If any of the above change, Unity re-imports the Asset. Otherwise, Unity downloads it from the Cache Server.</p>

<p>When you use a Cache Server, you can even share Asset imports across multiple projects (that is, the work of importing is done on one computer and the results are shared with others).</p>

<p><strong>Note:</strong> Once the Cache Server is <a href="#admin-setup">set up</a> and <a href="#enable">enabled</a>, this process is completely automatic, so there are no additional workflow requirements. It reduces the time it takes to import projects without further intervention from the user.</p>

<p><a name="enable"></a></p>

<h2>Enabling a Cache Server</h2>

<p>To enable a Cache Server:</p>

<ol>
<li>Open the Unity <strong>Preferences</strong> window (from the main menu: <strong>Unity</strong> &gt; <strong>Preferences</strong> on MacOS or <strong>Edit</strong> &gt; <strong>Preferences</strong> on Windows and Linux).</li>
<li>Select <strong>Cache Server</strong> from the category list on the left. The <strong>Cache Server</strong> settings appear in the details pane on the right.</li>
<li>Choose <strong>Remote</strong> or <strong>Local</strong> from the <strong>Cache Server Mode</strong> drop-down box. The properties unique to the selected mode appear.</li>
<li>Set the <a href="Preferences.html#Cache-Server">Cache Server preferences</a> for the mode you selected.</li>
</ol>

<p><strong>Tip:</strong> It is better to host the Cache Server on a separate computer if possible because of hard drive size limitations. </p>

<p><strong>Note:</strong> If you have a local Cache Server with a custom location, and that location becomes unavailable, Unity displays the following warning:</p>

<blockquote>
<p><em>Local cache directory does not exist - please check that you can access the cache folder and are able to write to it</em></p>
</blockquote>

<p><a name="admin-setup"></a></p>

<h2>Setting up a <strong>Cache Server</strong> as an administrator</h2>

<p>Administrators need to set up the <strong>Cache Server</strong> computer that hosts the cached Assets. </p>

<p>To set up the Cache Server on a remote server:</p>

<ol>
<li>Download the Cache Server:

<ul>
<li>Open Unity’s <a href="https://unity3d.com/get-unity/download/archive">Download Archive</a> page.</li>
<li>Locate the Unity version you are using and click the <strong>Downloads</strong> button for your target server’s operating system.</li>
<li>Click the <strong>Cache Server</strong> link to start the download.</li>
</ul>
</li>
<li>Unzip the file, which looks like this:
 <img src="../uploads/Main/CacheServerZipCropped.png" alt="">
</li>
<li>Run the command script that matches your operating system.
 A terminal window appears, indicating that the Cache Server is running in the background:
 <img src="../uploads/Main/CacheServerTerminal.png" alt="">
</li>
</ol>

<p><strong>Important:</strong> The Cache Server needs to be on a reliable computer with very large storage (much larger than the size of the project itself, as there will be multiple versions of imported resources stored). If the hard disk becomes full the Cache Server could perform slowly.</p>

<h2>将缓存服务器安装为服务</h2>

<p>必须将提供的 <code>.sh</code> 和 <code>.cmd</code> 脚本设置为服务器上的服务。
缓存服务器可以随时安全地终止和重新启动，因为它使用原子文件操作。</p>

<h2>新版和旧版缓存服务器</h2>

<p>默认情况下启动两个缓存服务器进程。旧版缓存服务器适用于 5.0 之前的 Unity 版本。新版缓存服务器适用于 5.0 和之后的 Unity 版本。有关配置、启用和禁用两个不同缓存服务器的详细信息，请参阅下面的缓存服务器配置。</p>

<h2>缓存服务器配置</h2>

<p>如果通过执行脚本直接启动，将在端口 8125 上启动旧版缓存服务器，而在端口 8126 上启动新版缓存服务器。此外还会在与脚本相同的目录中创建“cache”和“cache5.0”目录，并在其中保存数据。默认情况下，缓存目录最多可增长到 50 GB。可以使用命令行选项配置数据的大小和位置，如下所示：</p>

<p><code>./RunOSX.command --path ~/mycachePath --size 2000000000</code></p>

<p>或者</p>

<p><code>./RunOSX.command --path ~/mycachePath --port 8199 --nolegacy</code></p>

<p>可以使用以下命令行选项配置缓存服务器：</p>

<ul>
<li>使用 <code>--port</code> 指定服务器端口。这仅适用于新版缓存服务器。默认值为 <code>8126</code>。</li>
<li>使用 <code>--path</code> 指定缓存位置的路径。这仅适用于新版缓存服务器。默认值为 <code>./cache5.0</code>。</li>
<li>使用 <code>--legacypath</code> 指定缓存位置的路径。这仅适用于旧版缓存服务器。默认值为 <code>./cache</code>。</li>
<li>使用 <code>--size</code> 指定两个缓存服务器的最大缓存大小（以字节为单位）。超过此缓存大小时，将自动丢弃最近未使用的文件。</li>
<li>使用 <code>--nolegacy</code> 禁止启动旧版缓存服务器。否则，旧版缓存服务器会在端口 <code>8125</code> 上启动。</li>
</ul>

<h2>托管缓存服务器的计算机的要求</h2>

<p>为获得最佳性能，必须有足够的 RAM 来容纳整个导入的项目文件夹。此外，计算机最好配备快速硬盘驱动器和快速以太网连接。硬盘驱动器还应该有足够的可用空间。另一方面，缓存服务器的 CPU 使用率非常低。</p>

<p>缓存服务器和版本控制系统之间的主要区别之一是其缓存的数据始终可以在本地重建。它只是一种提高性能的工具。因此，在互联网上使用缓存服务器是没有意义的。如果是分布式团队，应在每个位置放置单独的缓存服务器。</p>

<p>缓存服务器在 Linux 或 Mac OS X 计算机上的运行效果最好。Windows 文件系统没有针对缓存服务器的数据存储方式进行很好的特别优化，并且 Windows 上的文件锁定问题可能会导致一些在 Linux 或 Mac OS X 上不会出现的问题。</p>

<h2>关于缓存服务器的常见问题解答</h2>

<h3>随着导入和存储的资源越来越多，缓存服务器数据库的大小会无限增长吗？</h3>

<p>缓存服务器会自动删除一段时间未使用的资源（当然，如果再次需要这些资源，则会在下次使用时重新创建这些资源）。</p>

<h3>缓存服务器是否仅适用于资源服务器 (Asset Server)？</h3>

<p>根据设计，缓存服务器对源代码/版本控制系统而言是透明的，因此不局限于使用 Unity 的资源服务器。</p>

<h3>哪些更改会导致重新生成导入的文件？</h3>

<p>当 Unity 即将导入资源时，它会生成所有源数据的 MD5 哈希值。</p>

<p>对于纹理，这包括：</p>

<ul>
<li>源资源：“myTexture.psd”文件</li>
<li>元文件：“myTexture.psd.meta”（存储所有导入器设置）</li>
<li>纹理导入器的内部版本号</li>
<li>所有 <a href="../ScriptReference/AssetPostprocessor.html">AssetPostprocessor</a> 的版本号哈希值</li>
</ul>

<p>如果该哈希值与缓存服务器上存储的哈希值不同，则重新导入资源。否则，将下载缓存版本。客户端 Unity Editor 仅在需要时从服务器中拉取资源 - 资源在更改时不会被推送到每个项目。</p>

<h3>如何使用资源依赖项？</h3>

<p>缓存服务器不处理依赖项。Unity 的资源管线不处理依赖项的概念。根据设计，它会避免资源之间的依赖关系。<a href="../ScriptReference/AssetPostprocessor.html">AssetPostprocessor</a> 类是一种用于自定义资源导入器来满足需求的常用技术。例如，有时可能希望将网格碰撞体添加到 .fbx 文件中的某些游戏对象（基于名称或标签）。</p>

<p>使用 <code>AssetPostprocessor</code> 来引入依赖项也很容易。例如，可以使用资源旁边的文本文件中的数据向导入的游戏对象添加其他组件。缓存服务器不支持此功能。如果要使用缓存服务器，必须去除对项目文件夹中其他资源的依赖。由于缓存服务器对后处理器中的依赖项一无所知，因此它不知道是否任何内容已发生更改，因此会使用资源的旧缓存版本。</p>

<p>在实践中，可以通过多种方式进行资源后期处理，以便与缓存服务器配合使用。可以使用：</p>

<ul>
<li>已导入资源的路径</li>
<li>资源的任何导入设置</li>
<li>源资源本身或在其基础上生成的任何数据（在资源后处理器中传递给您）。</li>
</ul>

<h3>使用材质时是否有任何问题？</h3>

<p>Modifying Materials that already exist might cause problems. When using the Cache Server, Unity validates that the references to Materials are maintained, but because no postprocessing calls are invoked, the contents of the Material cannot be changed when a model is imported through the Cache Server. Because of this, you might get different results when importing with and without the Cache Server. </p>

<p>Don’t modify materials that already exist on disk from an Asset postprocessor because if you download an fbx file through the cache server, then there is no import process running for it. So if you rely on resetting the generated materials to some generated defaults every time the model importer runs, then this Asset postprocessor will not be run when importing a cached fbx file.</p>

<h3>是否有任何资源类型不会被服务器缓存？</h3>

<p>There are a few kinds of Asset data which the server doesn’t cache. There isn’t really anything to be gained by caching script files, so the server ignores them. Also, native files used by 3D modeling software (Autodesk® Maya®, Autodesk® 3ds Max®, etc) are converted to FBX using the application itself. The Asset server does not cache the native file nor the intermediate FBX file generated in the import process. However, it is possible to benefit from the server, by exporting files as FBX from the modeling software and then adding those to the Unity project.</p>

<hr>

<ul>
<li><span class="page-edit">2018–11–09 Page amended with limited <a href="DocumentationEditorialReview.html">editorial review</a>
</span></li>
</ul>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="ClassIDReference.html"></a></span><div class="tip">YAML 类 ID 参考</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="ModifyingSourceAssetsThroughScripting.html"></a></span><div class="tip">通过脚本修改源资源</div>
</div>
</div>
</div>
<div class="footer-wrapper">
<div class="footer clear">
<div class="copy">Copyright © 2019 Unity Technologies. Publication 2019.1</div>
<div class="menu">
<a href="https://unity3d.com/learn">Tutorials</a><a href="https://answers.unity3d.com">Community Answers</a><a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a><a href="https://forum.unity3d.com">Forums</a><a href="https://unity3d.com/asset-store">Asset Store</a>
</div>
</div>
<div></div>
</div>
</div></div></div>
</div>
</body>
</html>
