<!DOCTYPE html><html class="no-js">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-5V25JL6');
    </script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<meta property="og:title" content="Debugging DirectX 11/12 shaders with Visual Studio - Unity Manual">
<title>Debugging DirectX 11/12 shaders with Visual Studio - Unity Manual</title>
<meta property="og:image" content="https://docs.unity3d.com/zh_CN/2019.1/uploads/Main/InstallingGraphicsDebugger.jpg">
<meta name="description" content="Use the Graphics Debugger in Microsoft Visual Studio (2012 version or later) to capture individual frames of applications for debugging purposes, from platforms like Unity Editor, Windows Standalone or Universal Windows Platform.">
<meta property="og:description" content="Use the Graphics Debugger in Microsoft Visual Studio (2012 version or later) to capture individual frames of applications for debugging purposes, from platforms like Unity Editor, Windows Standalone or Universal Windows Platform.">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="../StaticFiles/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFiles/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFiles/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFiles/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFiles/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFiles/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFiles/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFiles/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFiles/images/favicons/tileicon-144x144.png">
<script>
      var docs_type = 'Manual';
      var lang = 'zh_CN';
      var page = 'SL-DebuggingD3D11ShadersWithVS';
      if(!page) page = 'index';
      var version = '2019.1';
      var docs_versions = [{version: '2019.3',version_string: '2019.3'},{version: '2019.2',version_string: '2019.2'},{version: '2019.1',version_string: '2019.1'},{version: '2018.4',version_string: '2018.4'},{version: '2018.3',version_string: '2018.3'},{version: '2018.2',version_string: '2018.2'},{version: '2018.1',version_string: '2018.1'},{version: '2017.4',version_string: '2017.4'},{version: '2017.3',version_string: '2017.3'},{version: '2017.2',version_string: '2017.2'},{version: '2017.1',version_string: '2017.1'},{version: '5.6',version_string: '560'},];</script><script type="text/javascript" src="../StaticFiles/js/jquery.js"></script><script type="text/javascript" src="../StaticFiles/js/core.js"></script><script type="text/javascript" src="../StaticFiles/js/jquery.sidebar.min.js"></script><script type="text/javascript" src="docdata/toc.js"></script><script type="text/javascript" src=""></script><script type="text/javascript" src="../StaticFiles/js/custom.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/core.css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/custom.css">
</head>
<body>
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5V25JL6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="https://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul class="menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">Manual</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">Scripting API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity3d.com/">
                unity3d.com
              </a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2019.1</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;"><ul>
<li><a class="docs_version_url_2019.3" href="/zh_CN/2019.3/Manual/SL-DebuggingD3D11ShadersWithVS.html">2019.3</a></li>
<li><a class="docs_version_url_2019.2" href="/zh_CN/2019.2/Manual/SL-DebuggingD3D11ShadersWithVS.html">2019.2</a></li>
<li><a class="docs_version_url_2019.1" href="/zh_CN/2019.1/Manual/SL-DebuggingD3D11ShadersWithVS.html">2019.1</a></li>
<li><a class="docs_version_url_2018.4" href="/zh_CN/2018.4/Manual/SL-DebuggingD3D11ShadersWithVS.html">2018.4</a></li>
<li><a class="docs_version_url_2018.3" href="/zh_CN/2018.3/Manual/SL-DebuggingD3D11ShadersWithVS.html">2018.3</a></li>
<li><a class="docs_version_url_2018.2" href="/zh_CN/2018.2/Manual/SL-DebuggingD3D11ShadersWithVS.html">2018.2</a></li>
<li><a class="docs_version_url_2018.1" href="/zh_CN/2018.1/Manual/SL-DebuggingD3D11ShadersWithVS.html">2018.1</a></li>
<li><a class="docs_version_url_2017.4" href="/zh_CN/2017.4/Manual/SL-DebuggingD3D11ShadersWithVS.html">2017.4</a></li>
<li><a class="docs_version_url_2017.3" href="/zh_CN/2017.3/Manual/SL-DebuggingD3D11ShadersWithVS.html">2017.3</a></li>
<li><a class="docs_version_url_2017.2" href="/zh_CN/2017.2/Manual/SL-DebuggingD3D11ShadersWithVS.html">2017.2</a></li>
<li><a class="docs_version_url_2017.1" href="/zh_CN/2017.1/Manual/SL-DebuggingD3D11ShadersWithVS.html">2017.1</a></li>
<li><a class="docs_version_url_560" href="/zh_CN/560/Manual/SL-DebuggingD3D11ShadersWithVS.html">5.6</a></li>
</ul></div>
</div>
<ul class="nav-menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">Manual</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">Scripting API</a></li>
</ul>
<div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">Language:
        <span class="b">中文</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a data-lang="en" href="/2019.1/Documentation/Manual/SL-DebuggingD3D11ShadersWithVS.html">English</a></li>
<li><a data-lang="ja" href="/ja/2019.1/Manual/SL-DebuggingD3D11ShadersWithVS.html">日本語</a></li>
<li><a data-lang="es" href="/es/2019.1/Manual/SL-DebuggingD3D11ShadersWithVS.html">Español</a></li>
<li><a data-lang="kr" href="/kr/2019.1/Manual/SL-DebuggingD3D11ShadersWithVS.html">한국어</a></li>
</ul></div>
</div>
</div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar hidden"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc">
<h2>Manual</h2>
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2019.1</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;"><ul>
<li><a class="docs_version_url_2019.3" href="/zh_CN/2019.3/Manual/SL-DebuggingD3D11ShadersWithVS.html">2019.3</a></li>
<li><a class="docs_version_url_2019.2" href="/zh_CN/2019.2/Manual/SL-DebuggingD3D11ShadersWithVS.html">2019.2</a></li>
<li><a class="docs_version_url_2019.1" href="/zh_CN/2019.1/Manual/SL-DebuggingD3D11ShadersWithVS.html">2019.1</a></li>
<li><a class="docs_version_url_2018.4" href="/zh_CN/2018.4/Manual/SL-DebuggingD3D11ShadersWithVS.html">2018.4</a></li>
<li><a class="docs_version_url_2018.3" href="/zh_CN/2018.3/Manual/SL-DebuggingD3D11ShadersWithVS.html">2018.3</a></li>
<li><a class="docs_version_url_2018.2" href="/zh_CN/2018.2/Manual/SL-DebuggingD3D11ShadersWithVS.html">2018.2</a></li>
<li><a class="docs_version_url_2018.1" href="/zh_CN/2018.1/Manual/SL-DebuggingD3D11ShadersWithVS.html">2018.1</a></li>
<li><a class="docs_version_url_2017.4" href="/zh_CN/2017.4/Manual/SL-DebuggingD3D11ShadersWithVS.html">2017.4</a></li>
<li><a class="docs_version_url_2017.3" href="/zh_CN/2017.3/Manual/SL-DebuggingD3D11ShadersWithVS.html">2017.3</a></li>
<li><a class="docs_version_url_2017.2" href="/zh_CN/2017.2/Manual/SL-DebuggingD3D11ShadersWithVS.html">2017.2</a></li>
<li><a class="docs_version_url_2017.1" href="/zh_CN/2017.1/Manual/SL-DebuggingD3D11ShadersWithVS.html">2017.1</a></li>
<li><a class="docs_version_url_560" href="/zh_CN/560/Manual/SL-DebuggingD3D11ShadersWithVS.html">5.6</a></li>
</ul></div>
</div>
<div class="clear"></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap opened-sidebar"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity User Manual (2019.1)</a></li>
<li><a href="Graphics.html">图形</a></li>
<li><a href="GraphicsReference.html">图形参考</a></li>
<li><a href="SL-Reference.html">着色器参考</a></li>
<li><a href="SL-AdvancedTopics.html">高级 ShaderLab 主题</a></li>
<li>Debugging DirectX 11/12 shaders with Visual Studio</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="SL-TextureArrays.html"></a></span><div class="tip">纹理数组</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="DebuggingShadersWithPIX.html"></a></span><div class="tip">Debugging DirectX 12 shaders with PIX</div>
</div>
</div></div>
<h1>Debugging DirectX 11/12 shaders with Visual Studio</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>Use the Graphics Debugger in Microsoft Visual Studio (2012 version or later) to capture individual frames of applications for debugging purposes, from platforms like Unity Editor, Windows Standalone or Universal Windows Platform.</p>

<p>To install the Graphics Debugger in Visual Studio:</p>

<ol>
<li><p>Go to <strong>Tools </strong>&gt; <strong>Get Tools and Features</strong>
<img src="../uploads/Main/InstallingGraphicsDebugger.jpg" alt=""></p></li>
<li><p>On the <strong>Individual components</strong> tab, scroll to <strong>Games and Graphics</strong> and check the box for <strong>Graphics debugger and GPU profiler for DirectX</strong></p></li>
<li><p>Click <strong>Modify</strong></p></li>
<li><p>Wait for installation, then follow the instructions to restart your computer</p></li>
</ol>

<h2>Capture DirectX shaders with Visual Studio</h2>

<p>You should use a built version of your Unity application to capture frames, rather than a version running in the Unity Editor. This is because the Editor might have multiple child windows open at once, and the Graphics Debugger might capture a frame from an unintended window.</p>

<h3>Steps to capture a frame from Unity Editor or Windows Standalone</h3>

<p>To use the Graphics Debugger on either of these two platforms, you need to create a dummy Visual Studio Project:</p>

<ol>
<li><p>Launch Visual Studio 2017</p></li>
<li><p>Go to <strong>File</strong> &gt; <strong>New</strong> &gt; <strong>Project</strong> &gt; <strong>Visual C++</strong> &gt; <strong>Empty Project</strong></p></li>
<li><p>Go to <strong>Project</strong> &gt; <strong>Properties</strong> &gt; <strong>Configuration Properties</strong> &gt; <strong>Debugging</strong></p></li>
<li><p>In the <strong>Command</strong> field, replace $(TargetPath) with the path to the Unity Editor or Windows Standalone (for example, <em>C:\MyApp\MyApp.exe</em>)</p></li>
<li><p>If you want to force Windows Standalone or Unity Editor to run under DirectX 11, select <strong>Command Arguments</strong> and type <strong>-force-d3d11</strong>.
<img src="../uploads/Main/ShaderDebuggingVSProps.png" alt="Project Properties"></p></li>
<li><p>Go to <strong>Debug </strong>&gt; <strong>Graphics</strong> &gt; <strong>Start Graphics</strong> <strong>Debugging</strong></p></li>
<li><p>If everything is configured correctly, Unity displays the following text in the top-left corner of the application:
<img src="../uploads/Main/ShaderDebuggingStandalone.png" alt="Debugger messages in the Unity Editor"> </p></li>
<li><p>To capture a frame, use the Print Screen key on your keyboard, or click the <strong>Capture Frame</strong> box on the left side of the Visual Studio interface.
<img src="../uploads/Main/ShaderDebuggingCaptureFrame.png" alt="Capture Frame in the Visual Studio interface"></p></li>
</ol>

<h2>Debug DirectX shaders with Visual Studio</h2>

<p>To debug a shader, you have to compile with debug symbols. To do that, you need to insert <strong>#pragma enable_d3d11_debug_symbols.</strong></p>

<p>Your shader should look something like this:</p>

<pre><code>Shader "Custom/NewShader" {
    Properties {
        _MainTex ("Base (RGB)", 2D) = "white" {}
    }
    SubShader {
        Tags { "RenderType"="Opaque" }
        LOD 200
        
        CGPROGRAM
        #pragma surface surf Lambert
        #pragma enable_d3d11_debug_symbols
        sampler2D _MainTex;

        struct Input {
            float2 uv_MainTex;
        };

        void surf (Input IN, inout SurfaceOutput o) {
            half4 c = tex2D (_MainTex, IN.uv_MainTex);
            o.Albedo = c.rgb;
            o.Alpha = c.a;
        }
        ENDCG
    } 
    FallBack "Diffuse"
}

</code></pre>

<h2>Example workflow</h2>

<p>Let’s create a basic example to show the entire process:</p>

<ol>
<li><p>Create a new Unity project (see documentation on <a href="GettingStarted.html">Getting Started</a>).</p></li>
<li><p>In the top menu, go to <strong>Assets</strong> &gt; <strong>Create</strong> &gt; <strong>Shader</strong> &gt; <strong>Standard Surface Shader</strong>. This creates a new shader file in your <strong>Project</strong> folder.</p></li>
<li><p>Select the shader file, and in the Inspector window, click <strong>Open</strong>. This opens the shader file in your scripting editor. Insert <code>#pragma enable_d3d11_debug_symbols</code> into the shader code, underneath the other <code>#pragma</code> lines.</p></li>
<li><p>Create a new Material (menu: <strong>Assets</strong> &gt; <strong>Create</strong> &gt; <strong>Material</strong>).</p></li>
<li><p>In the Material’s Inspector window, select the <strong>Shader</strong> dropdown, go to <strong>Custom</strong>, and select the shader you just created. </p></li>
<li><p>Create a 3D cube GameObject (menu: <strong>GameObject</strong> &gt; <strong>3D Object</strong> &gt; <strong>Cube</strong>).</p></li>
<li><p>Assign your new Material to your new GameObject. To do this, drag the Material from the <strong>Project</strong> window to the 3D cube.</p></li>
<li><p>Build the project for Windows Standalone. Note that real projects might be so large that building them every time you want to debug a shader becomes inefficient; in that case, debug in the Editor, but make sure your capture has profiled the correct window.</p></li>
<li><p>Capture a frame, using the steps described above in the section <strong>Capture DirectX shaders with Visual Studio</strong>.</p></li>
<li>
<p>Your captured frame appears in Visual Studio. Right-click it, and select <strong>Pixel.</strong></p>

<figure>
<img src="../uploads/Main/ShaderDebuggingCapturedFrame.png" alt="Captured frame, History, and selecting a pixel of an object which has the custom shader assigned.">
<figcaption>Captured frame, <strong>History</strong>, and selecting a <strong>pixel</strong> of an object which has the custom shader assigned.</figcaption>
</figure>
</li>
<li><p>Click the play button next to the Vertex Shader (highlighted in the screenshot above). This opens the vertex shader file:
<img src="../uploads/Main/ShaderDebuggingVertexShader.png" alt="Debugging vertex shader"></p></li>
</ol>

<p>There is a known issues while working with DirectX 12, in which the play buttons are not available, and the following error appears: This draw call uses system-value semantics that interfere with pixel history computation. If you experience this, use <a href="DebuggingShadersWithPIX.html">PIX</a> to debug your shaders instead.</p>

<h3>通用 Windows 平台</h3>

<p>When you debug for Universal Windows Platform, you don’t need to create a dummy Visual Studio project, because Unity creates it for you. </p>

<p>Steps to capture a frame and begin shader debugging are the same as they are for the Unity Editor or Windows Standalone.</p>

<h2>备用着色器调试技术</h2>

<p>You can also use <a href="RenderDocIntegration.html">RenderDoc</a> to debug shaders. In RenderDoc, you capture the <strong>Scene</strong> from within the Editor, then use the standalone tool for debugging.</p>

<p><a href="DebuggingShadersWithPIX.html">PIX</a> works in a similar way to Visual Studio’s Graphics Debugger. Use PIX instead of the Graphics Debugger to debug DirectX 12 projects.</p>

<hr>

<ul>
<li><span class="page-edit">2018–09–14 Page published with <a href="DocumentationEditorialReview.html">editorial review</a>
</span></li>
</ul>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="SL-TextureArrays.html"></a></span><div class="tip">纹理数组</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="DebuggingShadersWithPIX.html"></a></span><div class="tip">Debugging DirectX 12 shaders with PIX</div>
</div>
</div>
</div>
<div class="footer-wrapper">
<div class="footer clear">
<div class="copy">Copyright © 2019 Unity Technologies. Publication 2019.1</div>
<div class="menu">
<a href="https://unity3d.com/learn">Tutorials</a><a href="https://answers.unity3d.com">Community Answers</a><a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a><a href="https://forum.unity3d.com">Forums</a><a href="https://unity3d.com/asset-store">Asset Store</a>
</div>
</div>
<div></div>
</div>
</div></div></div>
</div>
</body>
</html>
