<!DOCTYPE html><html class="no-js">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-5V25JL6');
    </script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<meta property="og:title" content="光照故障排除和性能 - Unity Manual">
<title>光照故障排除和性能 - Unity Manual</title>
<meta property="og:image" content="https://docs.unity3d.com/zh_CN/2019.1/uploads/Main/LightPixVertComp.svg">
<meta name="description" content="可使用以下两种方法之一渲染光照：">
<meta property="og:description" content="可使用以下两种方法之一渲染光照：">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="../StaticFiles/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFiles/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFiles/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFiles/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFiles/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFiles/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFiles/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFiles/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFiles/images/favicons/tileicon-144x144.png">
<script>
      var docs_type = 'Manual';
      var lang = 'zh_CN';
      var page = 'LightPerformance';
      if(!page) page = 'index';
      var version = '2019.1';
      var docs_versions = [{version: '2019.3',version_string: '2019.3'},{version: '2019.2',version_string: '2019.2'},{version: '2019.1',version_string: '2019.1'},{version: '2018.4',version_string: '2018.4'},{version: '2018.3',version_string: '2018.3'},{version: '2018.2',version_string: '2018.2'},{version: '2018.1',version_string: '2018.1'},{version: '2017.4',version_string: '2017.4'},{version: '2017.3',version_string: '2017.3'},{version: '2017.2',version_string: '2017.2'},{version: '2017.1',version_string: '2017.1'},{version: '5.6',version_string: '560'},];</script><script type="text/javascript" src="../StaticFiles/js/jquery.js"></script><script type="text/javascript" src="../StaticFiles/js/core.js"></script><script type="text/javascript" src="../StaticFiles/js/jquery.sidebar.min.js"></script><script type="text/javascript" src="docdata/toc.js"></script><script type="text/javascript" src=""></script><script type="text/javascript" src="../StaticFiles/js/custom.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/core.css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/custom.css">
</head>
<body>
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5V25JL6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="https://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul class="menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">Manual</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">Scripting API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity3d.com/">
                unity3d.com
              </a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2019.1</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;"><ul>
<li><a class="docs_version_url_2019.3" href="/zh_CN/2019.3/Manual/LightPerformance.html">2019.3</a></li>
<li><a class="docs_version_url_2019.2" href="/zh_CN/2019.2/Manual/LightPerformance.html">2019.2</a></li>
<li><a class="docs_version_url_2019.1" href="/zh_CN/2019.1/Manual/LightPerformance.html">2019.1</a></li>
<li><a class="docs_version_url_2018.4" href="/zh_CN/2018.4/Manual/LightPerformance.html">2018.4</a></li>
<li><a class="docs_version_url_2018.3" href="/zh_CN/2018.3/Manual/LightPerformance.html">2018.3</a></li>
<li><a class="docs_version_url_2018.2" href="/zh_CN/2018.2/Manual/LightPerformance.html">2018.2</a></li>
<li><a class="docs_version_url_2018.1" href="/zh_CN/2018.1/Manual/LightPerformance.html">2018.1</a></li>
<li><a class="docs_version_url_2017.4" href="/zh_CN/2017.4/Manual/LightPerformance.html">2017.4</a></li>
<li><a class="docs_version_url_2017.3" href="/zh_CN/2017.3/Manual/LightPerformance.html">2017.3</a></li>
<li><a class="docs_version_url_2017.2" href="/zh_CN/2017.2/Manual/LightPerformance.html">2017.2</a></li>
<li><a class="docs_version_url_2017.1" href="/zh_CN/2017.1/Manual/LightPerformance.html">2017.1</a></li>
<li><a class="docs_version_url_560" href="/zh_CN/560/Manual/LightPerformance.html">5.6</a></li>
</ul></div>
</div>
<ul class="nav-menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">Manual</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">Scripting API</a></li>
</ul>
<div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">Language:
        <span class="b">中文</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a data-lang="en" href="/2019.1/Documentation/Manual/LightPerformance.html">English</a></li>
<li><a data-lang="ja" href="/ja/2019.1/Manual/LightPerformance.html">日本語</a></li>
<li><a data-lang="es" href="/es/2019.1/Manual/LightPerformance.html">Español</a></li>
<li><a data-lang="kr" href="/kr/2019.1/Manual/LightPerformance.html">한국어</a></li>
</ul></div>
</div>
</div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar hidden"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc">
<h2>Manual</h2>
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2019.1</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;"><ul>
<li><a class="docs_version_url_2019.3" href="/zh_CN/2019.3/Manual/LightPerformance.html">2019.3</a></li>
<li><a class="docs_version_url_2019.2" href="/zh_CN/2019.2/Manual/LightPerformance.html">2019.2</a></li>
<li><a class="docs_version_url_2019.1" href="/zh_CN/2019.1/Manual/LightPerformance.html">2019.1</a></li>
<li><a class="docs_version_url_2018.4" href="/zh_CN/2018.4/Manual/LightPerformance.html">2018.4</a></li>
<li><a class="docs_version_url_2018.3" href="/zh_CN/2018.3/Manual/LightPerformance.html">2018.3</a></li>
<li><a class="docs_version_url_2018.2" href="/zh_CN/2018.2/Manual/LightPerformance.html">2018.2</a></li>
<li><a class="docs_version_url_2018.1" href="/zh_CN/2018.1/Manual/LightPerformance.html">2018.1</a></li>
<li><a class="docs_version_url_2017.4" href="/zh_CN/2017.4/Manual/LightPerformance.html">2017.4</a></li>
<li><a class="docs_version_url_2017.3" href="/zh_CN/2017.3/Manual/LightPerformance.html">2017.3</a></li>
<li><a class="docs_version_url_2017.2" href="/zh_CN/2017.2/Manual/LightPerformance.html">2017.2</a></li>
<li><a class="docs_version_url_2017.1" href="/zh_CN/2017.1/Manual/LightPerformance.html">2017.1</a></li>
<li><a class="docs_version_url_560" href="/zh_CN/560/Manual/LightPerformance.html">5.6</a></li>
</ul></div>
</div>
<div class="clear"></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap opened-sidebar"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity User Manual (2019.1)</a></li>
<li><a href="Graphics.html">图形</a></li>
<li><a href="GraphicsOverview.html">图形概述</a></li>
<li><a href="LightingOverview.html">光照</a></li>
<li>光照故障排除和性能</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="GICache.html"></a></span><div class="tip">GI 缓存</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="LightingRelated.html"></a></span><div class="tip">相关主题</div>
</div>
</div></div>
<h1>光照故障排除和性能</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>可使用以下两种方法之一渲染光照：</p>

<ul>
<li><p>__顶点光照__仅计算网格顶点处的光照，并在表面其余部分插入顶点值。顶点光照不支持某些光照效果，但就处理开销而言，此方法是两种方法中成本较低的方法。另外，此方法可能是旧显卡上唯一可用的方法。</p></li>
<li><p>__像素光照__是在每个屏幕像素处单独计算的。虽然渲染速度较慢，但像素光照却支持一些顶点光照无法实现的效果。仅在使用像素光照的情况下才渲染法线贴图、光照剪影和实时阴影。此外，在像素模式下渲染时，聚光灯形状和点光源高光看起来要好得多。</p></li>
</ul>

<figure>
<img src="../uploads/Main/LightPixVertComp.svg" alt="聚光灯在像素模式与顶点模式下渲染的比较情况">
<figcaption>聚光灯在像素模式与顶点模式下渲染的比较情况</figcaption>
</figure>

<p>Lights have a big impact on rendering speed, so lighting quality must be traded off against frame rate. Since pixel lights have a much higher rendering overhead than vertex lights, Unity will only render the brightest lights at per-pixel quality and render the rest as vertex lights. The maximum number of pixel lights can be set in the <a href="class-QualitySettings.html">Quality</a> window for standalone build targets.</p>

<p>您可以使用 <strong>Render Mode</strong> 属性将光照渲染模式设置为像素光照。在决定是否将光照渲染为像素光照时，模式设置为 <strong>Important</strong> 的光照将被赋予更高的优先级。模式设置为 __Auto__（默认值）后，Unity 将根据给定对象受光照影响的程度自动对光照进行分类。渲染为像素光照的光照是根据逐个对象确定的。</p>

<p>有关更多信息，请参阅关于<a href="OptimizingGraphicsPerformance.html">优化图形性能</a>的页面。</p>

<h3>Lighting 窗口统计信息</h3>

<p>Lighting 窗口的底部将提供统计信息，显示有关运行时性能的重要指标。请参阅有关 <a href="GlobalIllumination.html">Lighting 窗口</a>的文档以了解更多详细信息。</p>

<h2>阴影性能</h2>

<p>实时阴影具有相当高的渲染开销，因此应谨慎使用它们。任何可能投射阴影的对象都必须首先渲染到阴影贴图中，然后该贴图将用于渲染可能接受阴影的对象。与上述的像素/顶点折中相比，启用阴影对性能的影响甚至更大。</p>

<p>柔和阴影比生硬阴影具有更大的渲染开销，但这仅影响 GPU，不会导致额外的 CPU 工作。</p>

<p>The <a href="class-QualitySettings.html">Quality</a> window includes a <strong>Shadow Distance</strong> value. Objects that are beyond this distance from the camera will be rendered with no shadows at all. Since the shadows on distant objects will not usually be noticed anyway, this can be a useful optimisation to reduce the number of shadows that must be rendered.</p>

<p>方向光的一种特殊问题是单个光照可能会照亮整个场景。此问题意味着阴影贴图通常会同时覆盖场景的大部分，这使得阴影容易受到称为“透视锯齿”的问题的影响。简单来说，透视锯齿是指靠近摄像机的阴影贴图像素看起来比那些更远的像素更“大块”。虽然可以增加阴影贴图分辨率以减少此影响，但结果会造成渲染资源浪费，因为远距离区域的阴影贴图在较低分辨率下看起来已经足够良好了。</p>

<p>A good solution to the problem is therefore to use separate shadow maps that decrease in resolution as the distance from camera increases. These separate maps are known as <strong>cascades</strong>. From the <a href="class-QualitySettings.html">Quality</a> window, you can choose zero, two or four cascades; Unity will calculate the positioning of the cascades within the camera’s frustum. Note that cascades are only enabled for directional lights. See <a href="DirLightShadows.html">directional light shadows</a> page for details.</p>

<h2>如何计算阴影贴图的大小</h2>

<p>计算贴图大小的第一步是确定光照可以照亮的屏幕视图区域。方向光可以照亮整个屏幕，但对于聚光灯和点光源，该区域是光源边界形状（点光源为球体，聚光灯为锥体）在屏幕上的投影。投影形状在屏幕上具有一定的宽度和高度（以像素为单位）；然后将这两个值中的较大者作为光照的“像素大小”。</p>

<p>When the shadow map resolution is set to <strong>High</strong> (from the <a href="class-QualitySettings.html">Quality</a> window) the shadow map’s size is calculated as follows:</p>

<ul>
<li>
<strong>方向光</strong>：<a href="../ScriptReference/Mathf.NextPowerOfTwo.html">NextPowerOfTwo</a> (pixelSize * 1.9)，(像素值* 1.9的结果，然后返回下一个2的幂的值），最大值为 2048。</li>
<li>
<strong>聚光灯</strong>：<a href="../ScriptReference/Mathf.NextPowerOfTwo.html">NextPowerOfTwo</a> (pixelSize)，(像素值，然后返回下一个2的幂的值），最大值为 1024。</li>
<li>
<strong>点光源</strong>：<a href="../ScriptReference/Mathf.NextPowerOfTwo.html">NextPowerOfTwo</a> (pixelSize * 0.5)，(像素值* 0.5的结果，然后返回下一个2的幂的值），最大值为 512。</li>
</ul>

<p>如果显卡有 512MB 或更大的视频内存，方向光的阴影贴图大小上限增加到 4096，聚光灯为 2048，而点光源为 1024。</p>

<p>阴影分辨率设置为 <em>Medium</em> 时，阴影贴图大小是阴影分辨率设置为 <strong>High</strong> 时的一半，而分辨率设置为 <em>Low</em> 时，阴影贴图大小变为其四分之一。</p>

<p>点光源的大小下限比其他类型的大，因为它们对阴影使用立方体贴图。这意味着此分辨率下的六个立方体贴图面必须同时保存在视频内存中。渲染它们的成本也非常高，因为潜在的阴影投射物可能需要渲染到所有六个立方体贴图面中。</p>

<h2>阴影故障排除</h2>

<p>如果您发现一个或多个对象未投射阴影，则应检查以下几点：</p>

<ul>
<li><p>旧的图形硬件可能不支持阴影。请参阅下面可处理阴影的最低硬件规格列表。</p></li>
<li><p>Shadows can be disabled in the <a href="class-QualitySettings.html">Quality</a> window. Make sure that you have the correct quality level enabled and that shadows are switched on for that setting.</p></li>
<li><p>场景中的所有<a href="class-MeshRenderer.html">网格渲染器</a>都必须正确设置相应的 <em>Receive Shadows</em> 和 <em>Cast Shadows</em>。默认情况下两者都已启用，但请检查确保未意外禁用它们。</p></li>
<li><p>只有不透明对象才投射和接受阴影，因此使用内置<a href="shader-TransparentFamily.html">透明</a>着色器或粒子着色器的对象既不会投射也不会接受阴影。通常，您可以使用<a href="shader-TransparentCutoutFamily.html">透明镂空</a>着色器代替具有“间隙”的对象，例如栅栏、植被等。自定义<a href="Shaders.html">着色器</a>必须采用像素光照并使用<a href="SL-SubShaderTags.html">几何渲染队列</a>。</p></li>
<li><p>使用__顶点光照 (VertexLit)__ 着色器的对象不能接受阴影，但可投射阴影。</p></li>
<li><p>使用<a href="RenderTech-ForwardRendering.html">前向渲染路径</a>，有些着色器只允许最亮的方向光投射阴影（这种情况尤其发生在 Unity 4.x 版本的旧版内置着色器中）。如果想使用多个阴影投射光，则应改用<a href="RenderTech-DeferredShading.html">延迟着色 (Deferred Shading)</a> 渲染路径。您可以使用 <code>fullforwardshadows</code> <a href="SL-SurfaceShaders.html">表面着色器</a> 指令启用您自己的着色器以支持“全阴影”。</p></li>
</ul>

<h2>阴影的硬件支持</h2>

<p>内置阴影几乎适用于 Unity 支持的所有设备。每个平台都支持以下卡：</p>

<h3>PC (Windows/Mac/Linux)</h3>

<ul>
<li>通常，所有 GPU 都支持阴影。某些非常旧的 GPU（例如，2005 年制造的 Intel GPU）可能存在例外。</li>
</ul>

<h3>移动端</h3>

<ul>
<li>iPhone 4 不支持阴影。从 iPhone 4S 和 iPad 2 开始的所有后续型号都支持阴影。</li>
<li>Android：需要 Android 4.0 或更高版本以及 <code>GL_OES_depth_texture</code> 支持。最值得注意的是，一些基于 Android Tegra 2/3 的 Android 设备不符合此要求，因此它们不支持阴影。</li>
<li>Windows Phone：仅 DX11-class GPU (Adreno 4xx/5xx) 支持阴影。</li>
</ul>

<h3>游戏主机</h3>

<ul>
<li>所有游戏主机都支持阴影。</li>
</ul>

<hr>

<ul>
<li><p><span class="page-edit"> 2017–06–08 Page published with limited <a href="DocumentationEditorialReview.html">editorial review</a>
</span></p></li>
<li><p><span class="page-history">在 5.6 版中添加了 Lighting 窗口统计信息</span></p></li>
</ul>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="GICache.html"></a></span><div class="tip">GI 缓存</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="LightingRelated.html"></a></span><div class="tip">相关主题</div>
</div>
</div>
</div>
<div class="footer-wrapper">
<div class="footer clear">
<div class="copy">Copyright © 2019 Unity Technologies. Publication 2019.1</div>
<div class="menu">
<a href="https://unity3d.com/learn">Tutorials</a><a href="https://answers.unity3d.com">Community Answers</a><a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a><a href="https://forum.unity3d.com">Forums</a><a href="https://unity3d.com/asset-store">Asset Store</a>
</div>
</div>
<div></div>
</div>
</div></div></div>
</div>
</body>
</html>
