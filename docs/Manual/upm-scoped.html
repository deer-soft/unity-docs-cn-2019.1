<!DOCTYPE html><html class="no-js">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-5V25JL6');
    </script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<meta property="og:title" content="Scoped package registries - Unity Manual">
<title>Scoped package registries - Unity Manual</title>
<meta name="description" content="A scoped registry allows you to use a registry in addition to the Unity default registry where you can host your own packages. Using scoped registries ensures that the Package Manager always maps a package to one and only one registry, guaranteeing a consistent result regardless of network conditions.">
<meta property="og:description" content="A scoped registry allows you to use a registry in addition to the Unity default registry where you can host your own packages. Using scoped registries ensures that the Package Manager always maps a package to one and only one registry, guaranteeing a consistent result regardless of network conditions.">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="../StaticFiles/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFiles/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFiles/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFiles/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFiles/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFiles/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFiles/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFiles/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFiles/images/favicons/tileicon-144x144.png">
<script>
      var docs_type = 'Manual';
      var lang = 'zh_CN';
      var page = 'upm-scoped';
      if(!page) page = 'index';
      var version = '2019.1';
      var docs_versions = [{version: '2019.3',version_string: '2019.3'},{version: '2019.2',version_string: '2019.2'},{version: '2019.1',version_string: '2019.1'},{version: '2018.4',version_string: '2018.4'},{version: '2018.3',version_string: '2018.3'},{version: '2018.2',version_string: '2018.2'},{version: '2018.1',version_string: '2018.1'},{version: '2017.4',version_string: '2017.4'},{version: '2017.3',version_string: '2017.3'},{version: '2017.2',version_string: '2017.2'},{version: '2017.1',version_string: '2017.1'},{version: '5.6',version_string: '560'},];</script><script type="text/javascript" src="../StaticFiles/js/jquery.js"></script><script type="text/javascript" src="../StaticFiles/js/core.js"></script><script type="text/javascript" src="../StaticFiles/js/jquery.sidebar.min.js"></script><script type="text/javascript" src="docdata/toc.js"></script><script type="text/javascript" src=""></script><script type="text/javascript" src="../StaticFiles/js/custom.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/core.css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/custom.css">
</head>
<body>
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5V25JL6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="https://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul class="menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">Manual</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">Scripting API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity3d.com/">
                unity3d.com
              </a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2019.1</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;"><ul>
<li><a class="docs_version_url_2019.3" href="/zh_CN/2019.3/Manual/upm-scoped.html">2019.3</a></li>
<li><a class="docs_version_url_2019.2" href="/zh_CN/2019.2/Manual/upm-scoped.html">2019.2</a></li>
<li><a class="docs_version_url_2019.1" href="/zh_CN/2019.1/Manual/upm-scoped.html">2019.1</a></li>
<li><a class="docs_version_url_2018.4" href="/zh_CN/2018.4/Manual/upm-scoped.html">2018.4</a></li>
<li><a class="docs_version_url_2018.3" href="/zh_CN/2018.3/Manual/upm-scoped.html">2018.3</a></li>
<li><a class="docs_version_url_2018.2" href="/zh_CN/2018.2/Manual/upm-scoped.html">2018.2</a></li>
<li><a class="docs_version_url_2018.1" href="/zh_CN/2018.1/Manual/upm-scoped.html">2018.1</a></li>
<li><a class="docs_version_url_2017.4" href="/zh_CN/2017.4/Manual/upm-scoped.html">2017.4</a></li>
<li><a class="docs_version_url_2017.3" href="/zh_CN/2017.3/Manual/upm-scoped.html">2017.3</a></li>
<li><a class="docs_version_url_2017.2" href="/zh_CN/2017.2/Manual/upm-scoped.html">2017.2</a></li>
<li><a class="docs_version_url_2017.1" href="/zh_CN/2017.1/Manual/upm-scoped.html">2017.1</a></li>
<li><a class="docs_version_url_560" href="/zh_CN/560/Manual/upm-scoped.html">5.6</a></li>
</ul></div>
</div>
<ul class="nav-menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">Manual</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">Scripting API</a></li>
</ul>
<div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">Language:
        <span class="b">中文</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a data-lang="en" href="/2019.1/Documentation/Manual/upm-scoped.html">English</a></li>
<li><a data-lang="ja" href="/ja/2019.1/Manual/upm-scoped.html">日本語</a></li>
<li><a data-lang="es" href="/es/2019.1/Manual/upm-scoped.html">Español</a></li>
<li><a data-lang="kr" href="/kr/2019.1/Manual/upm-scoped.html">한국어</a></li>
</ul></div>
</div>
</div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar hidden"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc">
<h2>Manual</h2>
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2019.1</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;"><ul>
<li><a class="docs_version_url_2019.3" href="/zh_CN/2019.3/Manual/upm-scoped.html">2019.3</a></li>
<li><a class="docs_version_url_2019.2" href="/zh_CN/2019.2/Manual/upm-scoped.html">2019.2</a></li>
<li><a class="docs_version_url_2019.1" href="/zh_CN/2019.1/Manual/upm-scoped.html">2019.1</a></li>
<li><a class="docs_version_url_2018.4" href="/zh_CN/2018.4/Manual/upm-scoped.html">2018.4</a></li>
<li><a class="docs_version_url_2018.3" href="/zh_CN/2018.3/Manual/upm-scoped.html">2018.3</a></li>
<li><a class="docs_version_url_2018.2" href="/zh_CN/2018.2/Manual/upm-scoped.html">2018.2</a></li>
<li><a class="docs_version_url_2018.1" href="/zh_CN/2018.1/Manual/upm-scoped.html">2018.1</a></li>
<li><a class="docs_version_url_2017.4" href="/zh_CN/2017.4/Manual/upm-scoped.html">2017.4</a></li>
<li><a class="docs_version_url_2017.3" href="/zh_CN/2017.3/Manual/upm-scoped.html">2017.3</a></li>
<li><a class="docs_version_url_2017.2" href="/zh_CN/2017.2/Manual/upm-scoped.html">2017.2</a></li>
<li><a class="docs_version_url_2017.1" href="/zh_CN/2017.1/Manual/upm-scoped.html">2017.1</a></li>
<li><a class="docs_version_url_560" href="/zh_CN/560/Manual/upm-scoped.html">5.6</a></li>
</ul></div>
</div>
<div class="clear"></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap opened-sidebar"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity User Manual (2019.1)</a></li>
<li><a href="UnityOverview.html">在 Unity 中操作</a></li>
<li><a href="Packages.html">Packages</a></li>
<li><a href="upm-manifestPrj.html">Project manifest</a></li>
<li>Scoped package registries</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="upm-git.html"></a></span><div class="tip">Git URLs</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="upm-conflicts.html"></a></span><div class="tip">Package conflicts</div>
</div>
</div></div>
<h1>Scoped package registries</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>A scoped registry allows you to use a registry in addition to the Unity default registry where you can host your own packages. Using scoped registries ensures that the Package Manager always maps a package to one and only one registry, guaranteeing a consistent result regardless of network conditions.</p>

<p>For example, if you set up your own server where you are hosting some of the Unity packages, you could end up getting the package from the wrong registry if one registry is temporarily unavailable, even if the Package Manager always searches the registries in the same order. However, if you set up a scoped registry for your own server, the package always maps to one and only one registry, guaranteeing a consistent result regardless of network conditions.</p>

<h2>Supported registry types</h2>

<p>Unity Package Manager supports registries based on the <strong>npm</strong> protocol. You can use any off the shelf <strong>npm</strong> registry server and it should work, but <a href="https://www.npmjs.com/package/verdaccio">Verdaccio</a> is quick to set up and doesn’t require a lot of configuration. </p>

<p>Once you set up these servers, you can include them as <strong>scoped registries</strong>, which is the <a href="https://docs.npmjs.com/creating-and-publishing-scoped-public-packages">same concept that <strong>npm</strong> uses</a>.</p>

<h3>限制</h3>

<p>Some npm registry servers do not support searching all packages with the <code>/all</code> Web API route. The Package Manager Search API relies on configured scoped registries to support this old npm API protocol. It has an HTTP endpoint that returns the metadata of all published packages (for example, <code>https://registry.my-company.com/-/all</code>). </p>

<p>If you have a tool that uses the Package Manager API to list available packages, you might experience unexpected results if your registry does not support the old protocol. For example, in this case, the <strong>Packages</strong> window does not display packages from those scoped registries in the <strong>All packages</strong> tab. However, this limitation does not apply to package resolution, so you can still manually add packages from scoped registries to the Project manifest.</p>

<h2>Setting up a scoped registry</h2>

<p>To set up your scoped registries in your Project manifest, use the <a href="upm-manifestPrj.html#scopedRegistries">scopedRegistries</a> attribute, which takes an array of scoped registry configuration objects. Each object contains a <a href="#name">name</a>, a <a href="#url">url</a> location, and a list of <a href="#scopes">scopes</a> for each package name pattern you want to map to that scoped registry. When the Package Manager decides which registry to fetch a package from, it compares the package <strong>name</strong> to the <strong>scopes</strong> values and finds the registry whose <strong>scopes</strong> most closely match. </p>

<p>For example, in the Project manifest below, there are two scoped registries, <strong>Main</strong> and <strong>Tools</strong>:</p>

<pre><code class="json">{
  "scopedRegistries": [
    {
      "name": "Main",
      "url": "https://my.company.com/registry",
      "scopes": [
        "com.my-company", "com.my-company.tools.foo"
      ]
    },
    {
      "name": "Tools",
      "url": "https://my.company.com/tools-registry",
      "scopes": [
        "com.my-company.tools"
      ]
    }
  ],
  "dependencies": {
    "com.unity.cinemachine": "1.0.0",
    "com.unity.2d.common": "1.0.0",
    "com.unity.2d.animation": "1.0.0",
    "com.my-company.bar": "1.0.0"
  }
}

</code></pre>

<p>When a user requests the <strong>com.my-company.bar</strong> package, the Package Manager finds that the <strong>com.my-company.*</strong> namespace is the closest match to its name, and therefore fetches the package from the <strong>Main</strong> registry.</p>

<p>When a user requests the <strong>com.my-company.tools.foo</strong> package, the <strong>Main</strong> registry has a scope with a namespace that’s an exact match.</p>

<p>When a user requests the <strong>com.my-company.tools.animation</strong> package, the Package Manager finds that the <strong>com.my-company.tools.*</strong> namespace is the closest match to its name and therefore fetches the package from the <strong>Tools</strong> registry. Even though it also matches the <strong>Main</strong> scope, the <strong>com.my-company.*</strong> namespace is not as close a match.</p>

<p>When a user requests the <strong>com.other-company.bar</strong> package, the Package Manager doesn’t find a match in any of the scoped registries, and therefore fetches the package from the default registry.</p>

<h3>配置</h3>

<p>Configure scoped registries with the <a href="upm-manifestPrj.html#scopedRegistries">scopedRegistries</a> attribute in the Project manifest. The <strong>scopedRegistries</strong> attribute contains an array of entries (objects) that represent all of the registries. </p>

<p>Each registry object contains a unique <strong>name</strong>, a location (<strong>url</strong>), and an array of namespaces, or <strong>scopes</strong>. The Package Manager uses the scopes to match package names to registries.</p>

<table>
<colgroup>
<col style="text-align:left;">
<col style="text-align:left;">
<col style="text-align:left;">
</colgroup>

<thead>
<tr>
	<th style="text-align:left;"><strong>Attribute</strong></th>
	<th style="text-align:left;"><strong>JSON Type</strong></th>
	<th style="text-align:left;"><strong>描述</strong></th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">
<a name="name"></a><strong>name</strong>
</td>
	<td style="text-align:left;">String</td>
	<td style="text-align:left;">The scope name as it appears in the user interface. The <strong>Packages</strong> window displays this name in the <a href="upm-ui-details.html">package details view</a>. For example, <code>"name": "Tools"</code>.</td>
</tr>
<tr>
	<td style="text-align:left;">
<a name="url"></a><strong>url</strong>
</td>
	<td style="text-align:left;">String</td>
	<td style="text-align:left;">The URL to the <a href="https://docs.google.com/document/d/1-PW4l1iXWXm9k8Pm4Rbw_8_wCLRoAmnPUPn3li_c7zk/edit#heading=h.vbo63iu5tkve">npm-compatible registry</a>. For example, <code>"url": "https://my.company.com/tools-registry"</code>
</td>
</tr>
<tr>
	<td style="text-align:left;">
<a name="scopes"></a><strong>scopes</strong>
</td>
	<td style="text-align:left;">Array of Strings</td>
	<td style="text-align:left;">Array of scopes that you can map to a package name, either as an exact match on the package name, or as a namespace. <br><br>For example, <code>"scopes": [ "com.my-company", "com.my-company.tools.foo" ]</code> <br><br><strong>NOTE</strong>: This type of configuration assumes that packages follow the <a href="https://en.wikipedia.org/wiki/Reverse_domain_name_notation">Reverse domain name notation</a>. This ensures that <strong>com.unity</strong> is equivalent to <strong>com.unity.*</strong>.</td>
</tr>
</tbody>
</table>

<hr>

<ul>
<li><span class="page-edit">2019–04–11 Page published with <a href="DocumentationEditorialReview.html">editorial review</a>
</span></li>
</ul>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="upm-git.html"></a></span><div class="tip">Git URLs</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="upm-conflicts.html"></a></span><div class="tip">Package conflicts</div>
</div>
</div>
</div>
<div class="footer-wrapper">
<div class="footer clear">
<div class="copy">Copyright © 2019 Unity Technologies. Publication 2019.1</div>
<div class="menu">
<a href="https://unity3d.com/learn">Tutorials</a><a href="https://answers.unity3d.com">Community Answers</a><a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a><a href="https://forum.unity3d.com">Forums</a><a href="https://unity3d.com/asset-store">Asset Store</a>
</div>
</div>
<div></div>
</div>
</div></div></div>
</div>
</body>
</html>
