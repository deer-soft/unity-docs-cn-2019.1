<!DOCTYPE html><html class="no-js">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-5V25JL6');
    </script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<meta property="og:title" content="使用 WebGL 模板 - Unity Manual">
<title>使用 WebGL 模板 - Unity Manual</title>
<meta property="og:image" content="https://docs.unity3d.com/zh_CN/2019.1/uploads/Main/WebGLTemplate1.png">
<meta name="description" content="When you build a WebGL project, Unity embeds the player in an HTML page so that it can be played in the browser. The default page is a simple white page with a loading bar on a grey canvas. Alternatively, you can select a minimal template (with only the necessary boilerplate code to run the WebGL content) in the Player settings (menu: Edit &gt; Project Settings, then select the Player category).">
<meta property="og:description" content="When you build a WebGL project, Unity embeds the player in an HTML page so that it can be played in the browser. The default page is a simple white page with a loading bar on a grey canvas. Alternatively, you can select a minimal template (with only the necessary boilerplate code to run the WebGL content) in the Player settings (menu: Edit &gt; Project Settings, then select the Player category).">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="../StaticFiles/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFiles/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFiles/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFiles/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFiles/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFiles/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFiles/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFiles/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFiles/images/favicons/tileicon-144x144.png">
<script>
      var docs_type = 'Manual';
      var lang = 'zh_CN';
      var page = 'webgl-templates';
      if(!page) page = 'index';
      var version = '2019.1';
      var docs_versions = [{version: '2019.3',version_string: '2019.3'},{version: '2019.2',version_string: '2019.2'},{version: '2019.1',version_string: '2019.1'},{version: '2018.4',version_string: '2018.4'},{version: '2018.3',version_string: '2018.3'},{version: '2018.2',version_string: '2018.2'},{version: '2018.1',version_string: '2018.1'},{version: '2017.4',version_string: '2017.4'},{version: '2017.3',version_string: '2017.3'},{version: '2017.2',version_string: '2017.2'},{version: '2017.1',version_string: '2017.1'},{version: '5.6',version_string: '560'},];</script><script type="text/javascript" src="../StaticFiles/js/jquery.js"></script><script type="text/javascript" src="../StaticFiles/js/core.js"></script><script type="text/javascript" src="../StaticFiles/js/jquery.sidebar.min.js"></script><script type="text/javascript" src="docdata/toc.js"></script><script type="text/javascript" src=""></script><script type="text/javascript" src="../StaticFiles/js/custom.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/core.css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/custom.css">
</head>
<body>
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5V25JL6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="https://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul class="menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">Manual</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">Scripting API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity3d.com/">
                unity3d.com
              </a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2019.1</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;"><ul>
<li><a class="docs_version_url_2019.3" href="/zh_CN/2019.3/Manual/webgl-templates.html">2019.3</a></li>
<li><a class="docs_version_url_2019.2" href="/zh_CN/2019.2/Manual/webgl-templates.html">2019.2</a></li>
<li><a class="docs_version_url_2019.1" href="/zh_CN/2019.1/Manual/webgl-templates.html">2019.1</a></li>
<li><a class="docs_version_url_2018.4" href="/zh_CN/2018.4/Manual/webgl-templates.html">2018.4</a></li>
<li><a class="docs_version_url_2018.3" href="/zh_CN/2018.3/Manual/webgl-templates.html">2018.3</a></li>
<li><a class="docs_version_url_2018.2" href="/zh_CN/2018.2/Manual/webgl-templates.html">2018.2</a></li>
<li><a class="docs_version_url_2018.1" href="/zh_CN/2018.1/Manual/webgl-templates.html">2018.1</a></li>
<li><a class="docs_version_url_2017.4" href="/zh_CN/2017.4/Manual/webgl-templates.html">2017.4</a></li>
<li><a class="docs_version_url_2017.3" href="/zh_CN/2017.3/Manual/webgl-templates.html">2017.3</a></li>
<li><a class="docs_version_url_2017.2" href="/zh_CN/2017.2/Manual/webgl-templates.html">2017.2</a></li>
<li><a class="docs_version_url_2017.1" href="/zh_CN/2017.1/Manual/webgl-templates.html">2017.1</a></li>
<li><a class="docs_version_url_560" href="/zh_CN/560/Manual/webgl-templates.html">5.6</a></li>
</ul></div>
</div>
<ul class="nav-menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">Manual</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">Scripting API</a></li>
</ul>
<div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">Language:
        <span class="b">中文</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a data-lang="en" href="/2019.1/Documentation/Manual/webgl-templates.html">English</a></li>
<li><a data-lang="ja" href="/ja/2019.1/Manual/webgl-templates.html">日本語</a></li>
<li><a data-lang="es" href="/es/2019.1/Manual/webgl-templates.html">Español</a></li>
<li><a data-lang="kr" href="/kr/2019.1/Manual/webgl-templates.html">한국어</a></li>
</ul></div>
</div>
</div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar hidden"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc">
<h2>Manual</h2>
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2019.1</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;"><ul>
<li><a class="docs_version_url_2019.3" href="/zh_CN/2019.3/Manual/webgl-templates.html">2019.3</a></li>
<li><a class="docs_version_url_2019.2" href="/zh_CN/2019.2/Manual/webgl-templates.html">2019.2</a></li>
<li><a class="docs_version_url_2019.1" href="/zh_CN/2019.1/Manual/webgl-templates.html">2019.1</a></li>
<li><a class="docs_version_url_2018.4" href="/zh_CN/2018.4/Manual/webgl-templates.html">2018.4</a></li>
<li><a class="docs_version_url_2018.3" href="/zh_CN/2018.3/Manual/webgl-templates.html">2018.3</a></li>
<li><a class="docs_version_url_2018.2" href="/zh_CN/2018.2/Manual/webgl-templates.html">2018.2</a></li>
<li><a class="docs_version_url_2018.1" href="/zh_CN/2018.1/Manual/webgl-templates.html">2018.1</a></li>
<li><a class="docs_version_url_2017.4" href="/zh_CN/2017.4/Manual/webgl-templates.html">2017.4</a></li>
<li><a class="docs_version_url_2017.3" href="/zh_CN/2017.3/Manual/webgl-templates.html">2017.3</a></li>
<li><a class="docs_version_url_2017.2" href="/zh_CN/2017.2/Manual/webgl-templates.html">2017.2</a></li>
<li><a class="docs_version_url_2017.1" href="/zh_CN/2017.1/Manual/webgl-templates.html">2017.1</a></li>
<li><a class="docs_version_url_560" href="/zh_CN/560/Manual/webgl-templates.html">5.6</a></li>
</ul></div>
</div>
<div class="clear"></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap opened-sidebar"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity User Manual (2019.1)</a></li>
<li><a href="PlatformSpecific.html">特定于平台的信息</a></li>
<li><a href="webgl.html">WebGL</a></li>
<li><a href="webgl-gettingstarted.html">WebGL 开发入门</a></li>
<li>使用 WebGL 模板</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="webgl-interactingwithbrowserscripting.html"></a></span><div class="tip">WebGL：与浏览器脚本交互</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="webgl-cursorfullscreen.html"></a></span><div class="tip">WebGL 中的光标锁定和全屏模式</div>
</div>
</div></div>
<h1>使用 WebGL 模板</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>When you build a WebGL project, Unity embeds the player in an HTML page so that it can be played in the browser. The default page is a simple white page with a loading bar on a grey canvas. Alternatively, you can select a minimal template (with only the necessary boilerplate code to run the WebGL content) in the <strong>Player</strong> settings (menu: <strong>Edit</strong> &gt; <strong>Project Settings</strong>, then select the <strong>Player</strong> category).</p>

<figure>
<img src="../uploads/Main/WebGLTemplate1.png" alt="">
</figure>

<p>The built-in HTML pages are fine for testing and demonstrating a minimal Player, but for production purposes, it is often good to see the Player hosted in the page where it will eventually be deployed. For example, if the Unity content interacts with other elements in the page via the external call interface then it must be tested with a page that provides those interacting elements. Unity allows you to supply your own pages to host the Player by using <strong>WebGL templates</strong>.</p>

<h2>WebGL 模板的结构</h2>

<p>将自定义模板添加到项目中的方法是在 Assets 文件夹中创建名为“WebGLTemplates”的文件夹，并且模板本身将作为此文件夹中的子文件夹。每个模板文件夹都包含一个 <em>index.html</em> 文件以及页面所需的任何其他资源，例如图像或样式表。</p>

<figure>
<img src="../uploads/Main/WebGLTemplate2.png" alt="">
</figure>

<p>Once created, the template appears among the options on the <strong>Player</strong> settings. The name of the template is the same as its folder. Optionally, the folder can contain a file named <em>thumbnail.png</em>, which should have dimensions of 128x128 pixels. The thumbnail image is displayed in the inspector to hint at what the finished page will look like.</p>

<p>该 html 文件至少需要包含以下元素：</p>

<ul>
<li><p>Unity WebGL 加载程序的脚本标记：
<code>&lt;script src="%UNITY_WEBGL_LOADER_URL%"&gt;&lt;/script&gt;</code></p></li>
<li><p>Script for instantiating Unity: <code>&lt;script&gt; var unityInstance = UnityLoader.instantiate("unityContainer", "%UNITY_WEBGL_BUILD_URL%");&lt;/script&gt;</code></p></li>
<li><p>A <code>&lt;div&gt;</code> tag, which has an <em>id</em> that is used in the instantiation function. The contents of this div will be replaced with the Unity instance.</p></li>
</ul>

<h2><strong>UnityLoader.instantiate(container, url, override)</strong></h2>

<p><em>UnityLoader.instantiate</em> 负责创建内容的新实例。</p>

<ul>
<li><p><strong>container </strong>can be either a DOM element (normally a <code>&lt;div&gt;</code> element) or an id of a DOM element. If the DOM element is provided, then the Unity runtime will be instantiated immediately. If an id of a DOM element is provided, then the Unity runtime will be instantiated after the whole document is parsed (which means you can provide an id of a DOM element which has not yet been created at the time of <em>UnityLoader.instantiate()</em> call).</p></li>
<li><p><strong>url</strong> 指定 json 文件的地址，此文件包含有关构建的信息（可使用 <em>%UNITY_WEBGL_BUILD_URL%</em> 变量，构建时会自动解析该变量）。</p></li>
<li><p><strong>override</strong> is an optional parameter which can be used to override the default properties of the instance. For example, you can override the <em>compatibilityCheck</em>, <em>onProgress</em> and <em>popup</em> functions, as those are properties of the instance. Note that <em>Module </em>is a property of the instance as well, so the properties of the <em>Module </em>can be overridden at instantiation time too. Consider the following example:</p></li>
</ul>

<pre><code>UnityLoader.instantiate("MyContainer", "%UNITY_WEBGL_BUILD_URL%", {
  compatibilityCheck: function (unityInstance, onsuccess, onerror) {
    if (!UnityLoader.SystemInfo.hasWebGL) {
      unityInstance.popup("Your browser does not support WebGL",
        [{text: "OK", callback: onerror}]);
    } else if (UnityLoader.SystemInfo.mobile) {
      unityInstance.popup("Please note that Unity WebGL is not currently supported on mobiles. Press OK if you wish to continue anyway.",
        [{text: "OK", callback: onsuccess}]);
    } else if (["Edge", "Firefox", "Chrome", "Safari"].indexOf(UnityLoader.SystemInfo.browser) == -1) {
      unityInstance.popup("Please note that your browser is not currently supported for this Unity WebGL content. Press OK if you wish to continue anyway.",
        [{text: "OK", callback: onsuccess}]);
    } else {
      onsuccess();
    }
  },
  onProgress: MyProgressFunction,
  Module: {
    onRuntimeInitialized: MyInitializationCallbackFunction,
  },
});
</code></pre>

<h2>模板标签</h2>

<p>在构建过程中，Unity 会在页面文本中查找特殊标签字符串，并将这些字符串替换为 Editor 提供的值。这些字符串包括名称、屏幕尺寸以及有关播放器的其他有用信息。</p>

<p>Tags are delimited by percent signs (%) in the page source. For example, if the product name is defined as <strong>MyPlayer</strong> in the <strong>Player</strong> settings:</p>

<p><code>&lt;title&gt;%UNITY_WEB_NAME%&lt;/title&gt;</code></p>

<p>将在该构建生成的主机页面中使用</p>

<p><code>&lt;title&gt;MyPlayer&lt;/title&gt;</code></p>

<p>…in the host page generated for the build. The complete set of tags is given below:</p>

<ul>
<li><p>__UNITY_WEB_NAME__：播放器的名称。</p></li>
<li><p>__UNITY_WEBGL_LOADER_URL__：UnityLoader.js 脚本的 URL，该脚本用于执行构建的实例化。</p></li>
<li><p>__UNITY_WEBGL_BUILD_URL__：JSON 文件的 URL，该文件包含有关构建的所有必要信息。</p></li>
<li><p><strong>UNITY_WIDTH</strong> 和 __UNITY_HEIGHT__：播放器的屏幕宽度和高度（以像素为单位）。</p></li>
<li><p><strong>UNITY_CUSTOM_SOME_TAG</strong>: If you add a tag to the index file in the form <code>UNITY_CUSTOM_XXX</code>, then this tag will appear in the <strong>Player</strong> settings when your template is selected. For example, if you add <code>&amp;lt;title&amp;gt;Unity Player | %UNITY_CUSTOM_MYTAG%&amp;lt;/title&amp;gt;</code> to the source, the Player settings look like this:</p></li>
</ul>

<figure>
<img src="../uploads/Main/WebGLTemplate3.png" alt="">
</figure>

<p>标签名称旁边的文本框包含在构建期间将替换成的自定义标签的文本。</p>

<h2>示例</h2>

<p>为了说明模板标签的用途，下面提供了 Unity 用于其最小 WebGL 模板的 HTML 源代码。</p>

<pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang="en-us"&gt;

  &lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;
    &lt;title&gt;Unity WebGL Player | %UNITY_WEB_NAME%&lt;/title&gt;
    &lt;script src="%UNITY_WEBGL_LOADER_URL%"&gt;&lt;/script&gt;
    &lt;script&gt;
    var unityInstance = UnityLoader.instantiate("unityContainer", "%UNITY_WEBGL_BUILD_URL%");
    &lt;/script&gt;
  &lt;/head&gt;
  
  &lt;body&gt;
    &lt;div id="unityContainer" style="width: %UNITY_WIDTH%px; height: %UNITY_HEIGHT%px; margin: auto"&gt;&lt;/div&gt;
  &lt;/body&gt;
  
&lt;/html&gt;
</code></pre>

<p>最小模板和默认模板都可以在 Unity 安装文件夹中找到：Windows 上的 Editor\Data\PlaybackEngines\WebGLSupport\BuildTools\WebGLTemplates 下，或者 Mac 上的 /PlaybackEngines/WebGLSupport/BuildTools/WebGLTemplates 下。</p>

<h2>添加进度条</h2>

<p>Unity WebGL 内容将在加载时自动呈现默认进度条。您可以通过提供自己的进度函数作为附加的实例化参数来覆盖默认的加载进度条。例如：</p>

<pre><code>var unityInstance = UnityLoader.instantiate("unityContainer", "%UNITY_WEBGL_BUILD_URL%", {onProgress: UnityProgress});
</code></pre>

<p>where <code>UnityProgress</code> is a function of 2 arguments: <code>unityInstance</code> (identifies the unity instance the progressbar belongs to) and <code>progress</code> (a value from 0.0 to 1.0, providing information about the current loading progress).</p>

<p>例如，默认 WebGL 模板中的进度函数看起来如下所示：</p>

<pre><code>var unityInstance = UnityLoader.instantiate("unityContainer", "%UNITY_WEBGL_BUILD_URL%", {onProgress: UnityProgress});
</code></pre>

<p>例如，默认 WebGL 模板中的进度函数看起来如下所示：</p>

<pre><code>function UnityProgress(unityInstance, progress) {
  if (!unityInstance.Module)
    return;
  if (!unityInstance.logo) {
    unityInstance.logo = document.createElement("div");
    unityInstance.logo.className = "logo " + unityInstance.Module.splashScreenStyle;
    unityInstance.container.appendChild(unityInstance.logo);
  }
  if (!unityInstance.progress) {    
    unityInstance.progress = document.createElement("div");
    unityInstance.progress.className = "progress " + unityInstance.Module.splashScreenStyle;
    unityInstance.progress.empty = document.createElement("div");
    unityInstance.progress.empty.className = "empty";
    unityInstance.progress.appendChild(unityInstance.progress.empty);
    unityInstance.progress.full = document.createElement("div");
    unityInstance.progress.full.className = "full";
    unityInstance.progress.appendChild(unityInstance.progress.full);
    unityInstance.container.appendChild(unityInstance.progress);
  }
  unityInstance.progress.full.style.width = (100 * progress) + "%";
  unityInstance.progress.empty.style.width = (100 * (1 - progress)) + "%";
  if (progress == 1)
    unityInstance.logo.style.display = unityInstance.progress.style.display = "none";
}
</code></pre>

<p>可直接按原样使用，也可将其用作自己模板的参考。由于进度条完全在 JavaScript 中实现，因此可对其进行自定义或替换以显示所需的任何进度指示方式。</p>

<hr>

<ul>
<li><p><span class="page-edit">2018–10–18 Page amended with no <a href="DocumentationEditorialReview.html">editorial review</a>
</span></p></li>
<li><p><span class="page-history">5.6 版更新</span></p></li>
<li><p><span class="page-history">WebGL instance renamed from <code>gameInstance</code> to <code>unityInstance</code> in <a href="https://docs.unity3d.com/2019.1/Documentation/Manual/30_search.html?q=newin20191">2019.1</a> <span class="search-words">NewIn20191</span></span></p></li>
</ul>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="webgl-interactingwithbrowserscripting.html"></a></span><div class="tip">WebGL：与浏览器脚本交互</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="webgl-cursorfullscreen.html"></a></span><div class="tip">WebGL 中的光标锁定和全屏模式</div>
</div>
</div>
</div>
<div class="footer-wrapper">
<div class="footer clear">
<div class="copy">Copyright © 2019 Unity Technologies. Publication 2019.1</div>
<div class="menu">
<a href="https://unity3d.com/learn">Tutorials</a><a href="https://answers.unity3d.com">Community Answers</a><a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a><a href="https://forum.unity3d.com">Forums</a><a href="https://unity3d.com/asset-store">Asset Store</a>
</div>
</div>
<div></div>
</div>
</div></div></div>
</div>
</body>
</html>
